---
title: "Steady State Calculation"
structure: "User_Manual"
---

{% include header.html %}
{% include navbar.html %}
{% include structure.html %}

<div class="section">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">

The steady state is the state in which the state variables of the model, e.g. the species concentrations do not change in time. Mathematically this is expressed by setting the differential equations that describe the time evolution of the metabolic system to zero. This forms a system of algebraic non-linear equations. To solve them, COPASI can use a series of strategies using more than one numerical method.<br />
<br />
All calculations are done based on particle numbers and particle number rates rather than concentrations internally. The reduced model (see <a title="COPASI: Support/User Manual/The Model in COPASI/Deterministic Interpretation of the Model" href="{{ site.baseurl }}/Support/User_Manual/The_Model_in_COPASI/Deterministic_Interpretation_of_the_Model" >Deterministic Interpretation of the Model</a>) is used. The Jacobian (which is used in the Newton method and when eigenvalues of the Jacobian are requested) is calculated using finite differences. The Eigenvalues of the Jacobian are calculated using LAPACK.<br />
<h4 name="Options_for_Steady_State_Analysis">Options for Steady State Analysis</h4>
<dl><dt><b>Use Newton</b></dt><dd>This parameter is a Boolean value to determine whether to use the damped Newton method on the non-linear algebraic equations defining the steady-state. The initial concentrations set by the user are taken as guesses for the solution. A value of '1' (the default) indicates that COPASI shall use the damped Newton method.<br /> <br />The damped Newton method is a variant of the famous Newton method for the solution of systems of non-linear equations. The solution is obtained from an iterative procedure that refines an initial guess until the residual error is smaller than required. If a limit number of iterations is reached without an acceptable solution, the method halts without a solution.<br /> <br />The iteration of the plain Newton  method is:<br /> <br /><div align="center"><img class="latex-equation" style="vertical-align: middle; position: relative; bottom: 0px; height: 32; width: 126;" src="0d2d5f99141f5c01c44efbf3d2211858.png" alt="$x_{i} = x_{i-1}-\frac{f(x_{i-1})}{f'(x_{i-1})}$"></div><br /> <br />In the damped method if <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +1px; height: 8; width: 25;" src="c352de30da2ecc75c10b5d93261adef7.png" alt="$x_{i-1}$"> has a larger residual error than <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +1px; height: 8; width: 12;" src="972d704935c7ad4afb3f369dc4b02531.png" alt="$x_{i}$"> one looks at:<br /> <br /><div align="center"><img class="latex-equation" style="vertical-align: middle; position: relative; bottom: 0px; height: 32; width: 160;" src="b713bd3a57f599eab990e176ead645dd.png" alt="$x_{i}=x_{i-1}-\frac{f(x_{i-1})}{f'(x_{i-1})}\cdot2^{-n}$"> where <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: 0px; height: 12; width: 78;" src="8cc420a461511248e70e4fa9df0e4536.png" alt="$n=0, \ldots, 32$"></div><br /> <br /> and accepts the first such value that has a smaller residual error than <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +1px; height: 8; width: 12;" src="972d704935c7ad4afb3f369dc4b02531.png" alt="$x_{i}$">. If none is found, the procedure halts without a solution (because it is at a local minimum).</dd></dl><br />
<dl><dt><b>Use Integration</b></dt><dd> This parameter is a Boolean value to determine whether to use the <a title="COPASI: Support/User Manual/Methods/Time Course Calculation/Deterministic Simulation" href="{{ site.baseurl }}/Support/User_Manual/Methods/Time_Course_Calculation/Deterministic_Simulation" >deterministic ODE solver</a> to follow the time course defined by the differential equations until a steady state is reached. If at <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +3px; height: 12; width: 23;" src="06fa381baadcb92d10532d30b42046af.png" alt="$10^{10}$"> units of time no steady state has been reached the method halts with no solution. If Use Newton is '1' an attempt to find the Steady-state via the damped Newton method is made at each intermediate time point. A value of '1' (the default) indicates that COPASI shall use integration.</dd></dl><br />
<dl><dt><b>Use Back Integration</b></dt><dd> This parameter is a Boolean value to determine whether to use the <a title="COPASI: Support/User Manual/Methods/Time Course Calculation/Deterministic Simulation" href="{{ site.baseurl }}/Support/User_Manual/Methods/Time_Course_Calculation/Deterministic_Simulation" >deterministic ODE solver</a> to reverse the time course (going backwards in time) defined by the differential equations until a steady state is reached. If at <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +3px; height: 12; width: 23;" src="06fa381baadcb92d10532d30b42046af.png" alt="$10^{10}$"> units of time no Steady-State has been reached the method halts with no solution. If Use Newton is '1' an attempt to find the steady-state via the damped Newton method is made at each intermediate time point. A value of '1' indicates that COPASI shall use back integration.</dd></dl><br />
<dl><dt><b>Accept Negative Concentrations</b></dt><dd> This parameter is a boolean value to determine whether to accept a steady-state, which contains negative concentrations. A value of '1' indicates that negative concentrations are acceptable whereas a value of '0' (the default) indicates that such states are discarded.</dd></dl><br />
<dl><dt><b>Iteration Limit</b></dt><dd> This parameter is a positive integer to determine the maximum number of iterations the damped Newton method shall perform before it fails. The default is '50'.</dd></dl><br />
<dl><dt><b>Derivation Factor</b></dt><dd> This is a numeric value to determine the step size used to calculate <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +1px; height: 14; width: 48;" src="79543b63972da1758b7033dd59fc0b86.png" alt="$f'(x_{i-1})$">. The default is '0.001'.</dd></dl><br />
<dl><dt><b>Resolution</b></dt><dd> This is a positive numeric value to determine the resolution used to decide whether the current state is acceptable as a steady-state. If the absolute change of each state variable is smaller than the resolutions the state is accepted. The default is <img class="latex-equation" style="vertical-align: text-bottom; position: relative; bottom: +3px; height: 12; width: 27;" src="89aeab660920787b9a075e175fe69751.png" alt="$10^{-9}$">.<br /> <br /> Note, this value is interpreted as a concentration value, even though the calculation internally uses particle numbers. The reason for that is purely heuristic: In many cases the modeler will choose the units in a way that concentration values are neither extremely large nor extremely small numerically so that the default value for this parameter leads to useful results. However generally it is not save to just keep the default value without checking.</dd></dl><br />
<br />

      </div>
    </div>
  </div>
</div>

<!-- FOOTER  -->
{% include footer.html %}
