<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>COPASI API: CHybridMethod.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">COPASI API
   &#160;<span id="projectnumber">4.16.103</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_db7313a27b1cae523c7773e30bdf986c.html">copasi</a></li><li class="navelem"><a class="el" href="../../dir_b5f61c72b9c3dda97ea9ed0837ced632.html">trajectory</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CHybridMethod.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/d2d/CHybridMethod_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (C) 2010 - 2013 by Pedro Mendes, Virginia Tech Intellectual</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Properties, Inc., University of Heidelberg, and The University</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// of Manchester.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// All rights reserved.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Copyright (C) 2008 - 2009 by Pedro Mendes, Virginia Tech Intellectual</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Properties, Inc., EML Research, gGmbH, University of Heidelberg,</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// and The University of Manchester.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// All rights reserved.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Copyright (C) 2003 - 2007 by Pedro Mendes, Virginia Tech Intellectual</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Properties, Inc. and EML Research, gGmbH.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// All rights reserved.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   CHybridMethod</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *   This class implements an hybrid algorithm for the simulation of a</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *   biochemical system over time.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *   File name: CHybridMethod.cpp</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *   Author: Juergen Pahle</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *   Email: juergen.pahle@eml-r.villa-bosch.de</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *   Last change: 14, December 2004</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *   (C) European Media Lab 2003.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* DEFINE ********************************************************************/</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if _MSC_VER &lt; 1600</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define min _cpp_min</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define max _cpp_max</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif // _MSC_VER</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif // WIN32</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/df8/copasi_8h.html">copasi.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/dda/CHybridMethod_8h.html">CHybridMethod.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/de2/CTrajectoryProblem_8h.html">CTrajectoryProblem.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d90/CModel_8h.html">model/CModel.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/df5/CMetab_8h.html">model/CMetab.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dc3/CReaction_8h.html">model/CReaction.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d11/CState_8h.html">model/CState.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dff/CChemEq_8h.html">model/CChemEq.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d8d/CChemEqElement_8h.html">model/CChemEqElement.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d59/CCompartment_8h.html">model/CCompartment.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d51/CCopasiVector_8h.html">utilities/CCopasiVector.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dbd/CMatrix_8h.html">utilities/CMatrix.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d07/CDependencyGraph_8h.html">utilities/CDependencyGraph.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/ddb/CIndexedPriorityQueue_8h.html">utilities/CIndexedPriorityQueue.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d98/CRandom_8h.html">randomGenerator/CRandom.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4f/CVersion_8h.html">copasi/utilities/CVersion.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> *   Default constructor.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ab2b8e701113a89be59c412fe426b5fea">   63</a></span>&#160;<a class="code" href="../../d5/da3/classCHybridMethod.html#ad02c41eaa01fddb8d0bfb6a85202c019">CHybridMethod::CHybridMethod</a>(<span class="keyword">const</span> <a class="code" href="../../d9/dfd/classCCopasiContainer.html">CCopasiContainer</a> * pParent):</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html">CTrajectoryMethod</a>(<a class="code" href="../../df/d49/classCCopasiMethod.html">CCopasiMethod</a>::hybrid, pParent)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a> = <a class="code" href="../../df/dcb/classCRandom.html#af284fc89ba1c3e15f2463b12be647320">CRandom::createGenerator</a>(<a class="code" href="../../df/dcb/classCRandom.html#ae24dac97c3e9ec67a54db42f81b34f56a784a1373c483e406ff533f105c7a7af8">CRandom::mt19937</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">initializeParameter</a>();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ad02c41eaa01fddb8d0bfb6a85202c019">   70</a></span>&#160;<a class="code" href="../../d5/da3/classCHybridMethod.html#ad02c41eaa01fddb8d0bfb6a85202c019">CHybridMethod::CHybridMethod</a>(<span class="keyword">const</span> <a class="code" href="../../d5/da3/classCHybridMethod.html">CHybridMethod</a> &amp; src,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                             <span class="keyword">const</span> <a class="code" href="../../d9/dfd/classCCopasiContainer.html">CCopasiContainer</a> * pParent):</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html">CTrajectoryMethod</a>(src, pParent)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a> = <a class="code" href="../../df/dcb/classCRandom.html#af284fc89ba1c3e15f2463b12be647320">CRandom::createGenerator</a>(<a class="code" href="../../df/dcb/classCRandom.html#ae24dac97c3e9ec67a54db42f81b34f56a784a1373c483e406ff533f105c7a7af8">CRandom::mt19937</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">initializeParameter</a>();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> *   Destructor.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#afbaf36bd9870d7db0d13b76c4478e471">   81</a></span>&#160;<a class="code" href="../../d5/da3/classCHybridMethod.html#afbaf36bd9870d7db0d13b76c4478e471">CHybridMethod::~CHybridMethod</a>()</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a2f841429c7a79c2695aa696ac5820884">cleanup</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#afb56de89ba93afccedfe4db80fb5aa2e">DESTRUCTOR_TRACE</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">   87</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">CHybridMethod::initializeParameter</a>()</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="../../d5/db6/classCCopasiParameter.html">CCopasiParameter</a> *pParm;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Max Internal Steps&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a9e2b14ee7ce99139e3caa975794646ae">CCopasiParameter::INT</a>, (<a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#aa0414caef00a64a51d4c6c0711d9e70a">MAX_STEPS</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Lower Limit&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a3b736192222fcb8ee487a9c36bbd9867">CCopasiParameter::DOUBLE</a>, (<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#ab96a75318b9c264bf8aff3eb86b5a259">LOWER_STOCH_LIMIT</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Upper Limit&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a3b736192222fcb8ee487a9c36bbd9867">CCopasiParameter::DOUBLE</a>, (<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#a926b4fb85bd966e882755639126fe811">UPPER_STOCH_LIMIT</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Runge Kutta Stepsize&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a3b736192222fcb8ee487a9c36bbd9867">CCopasiParameter::DOUBLE</a>, (<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#aac0420de934a306a2b8ab1bfef784537">RUNGE_KUTTA_STEPSIZE</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Partitioning Interval&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a098d4c1de3342cc22177fe93ce9f5320">CCopasiParameter::UINT</a>, (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#a2fad04e91f10c55c7e0c006e32be2571">PARTITIONING_INTERVAL</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Use Random Seed&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56acccd91675f2cfef22208d6c1efeba228">CCopasiParameter::BOOL</a>, (<span class="keywordtype">bool</span>) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#afcabafc49128a4367fc72a9984da15cb">USE_RANDOM_SEED</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">assertParameter</a>(<span class="stringliteral">&quot;Random Seed&quot;</span>, <a class="code" href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a098d4c1de3342cc22177fe93ce9f5320">CCopasiParameter::UINT</a>, (<span class="keywordtype">unsigned</span> C_INT32) <a class="code" href="../../d2/dda/CHybridMethod_8h.html#a990edf51308a42b583fde55e2b9bedb7">RANDOM_SEED</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Check whether we have a method with the old parameter names</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;HYBRID.MaxSteps&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Max Internal Steps&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a50d26400fb0795a03ef6979f6a61f777">pINT</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;HYBRID.MaxSteps&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;HYBRID.LowerStochLimit&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Lower Limit&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;HYBRID.LowerStochLimit&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;HYBRID.UpperStochLimit&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Upper Limit&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;HYBRID.UpperStochLimit&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;HYBRID.RungeKuttaStepsize&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Runge Kutta Stepsize&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;HYBRID.RungeKuttaStepsize&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;HYBRID.PartitioningInterval&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Partitioning Interval&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#aff3513fc28ecdd68e86a60f5df54816b">pUINT</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;HYBRID.PartitioningInterval&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;UseRandomSeed&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Use Random Seed&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a8c94ab18ba3f3a90c861b5a86852a39e">pBOOL</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;UseRandomSeed&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">if</span> ((pParm = <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">getParameter</a>(<span class="stringliteral">&quot;&quot;</span>)) != NULL)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">setValue</a>(<span class="stringliteral">&quot;Random Seed&quot;</span>, *pParm-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>().<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#aff3513fc28ecdd68e86a60f5df54816b">pUINT</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <a class="code" href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">removeParameter</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a6a917962fc9d55685e4c62ec541de4ec">  143</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a6a917962fc9d55685e4c62ec541de4ec">CHybridMethod::elevateChildren</a>()</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">initializeParameter</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> *   Creates a HybridMethod adequate for the problem.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> *   (only CHybridNextReactionRKMethod so far)</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a5ee65df6b820ebc657dcf21bd146a6ed">  153</a></span>&#160;<a class="code" href="../../d5/da3/classCHybridMethod.html">CHybridMethod</a> *<a class="code" href="../../d5/da3/classCHybridMethod.html#a5ee65df6b820ebc657dcf21bd146a6ed">CHybridMethod::createHybridMethod</a>()</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> result = 1; <span class="comment">// hybrid NextReactionRungeKutta method as default</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">/*  if (pProblem &amp;&amp; pProblem-&gt;getModel())</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">      {</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">      result = checkModel(pProblem-&gt;getModel());</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">      }*/</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html">CHybridMethod</a> * method = NULL;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">switch</span> (result)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">/*    case - 3:        // non-integer stoichometry</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">        CCopasiMessage(CCopasiMessage::ERROR, MCTrajectoryMethod + 1);</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">        break;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">        case - 2:        // reversible reaction exists</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">        CCopasiMessage(CCopasiMessage::ERROR, MCTrajectoryMethod + 2);</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">        break;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">        case - 1:        // more than one compartment involved</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">        CCopasiMessage(CCopasiMessage::ERROR, MCTrajectoryMethod + 3);</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">        break;*/</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Everything alright: Hybrid simulation possible</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        method = <span class="keyword">new</span> <a class="code" href="../../d9/d92/classCHybridNextReactionRKMethod.html">CHybridNextReactionRKMethod</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">return</span> method;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ab31ca49dcc0b115f669dc28811d34a91">  184</a></span>&#160;<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#ab3518ff2426cb53acd8f96cd73abaa4f">CTrajectoryMethod::Status</a> <a class="code" href="../../d5/da3/classCHybridMethod.html#ab31ca49dcc0b115f669dc28811d34a91">CHybridMethod::step</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp; deltaT)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// write the current state to the model</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">//  mpProblem-&gt;getModel()-&gt;setState(mpCurrentState); // is that correct?</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// check for possible overflows</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">size_t</span> imax;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// :TODO: Bug 774: This assumes that the number of variable metabs is the number</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// of metabs determined by reaction. In addition they are expected at the beginning of the</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// MetabolitesX which is not the case if we have metabolites of type ODE.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">for</span> (i = 0, imax = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#ab917cbb21d517aaa490416066d57ebb0">getNumVariableMetabs</a>(); i &lt; imax; i++)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>()[i]-&gt;getValue() &gt;= <a class="code" href="../../d5/da3/classCHybridMethod.html#a203f66c74160cf0c70da56c6773979fc">mMaxIntBeforeStep</a>)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// throw exception or something like that</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// do several steps</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> time = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> endTime = time + deltaT;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">for</span> (i = 0; ((i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">mMaxSteps</a>) &amp;&amp; (time &lt; endTime)); i++)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      time = <a class="code" href="../../d5/da3/classCHybridMethod.html#a62b0ac745bc9bf066a1cd484029939cf">doSingleStep</a>(time, endTime);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#acc695ac82480dc0674b2df5fd9bc18e5">setTime</a>(time);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span> ((i &gt;= <a class="code" href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">mMaxSteps</a>) &amp;&amp; (!<a class="code" href="../../d5/da3/classCHybridMethod.html#a4cd08c91c12fe261a45100465b521ad0">mMaxStepsReached</a>))</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a4cd08c91c12fe261a45100465b521ad0">mMaxStepsReached</a> = <span class="keyword">true</span>; <span class="comment">//only report this message once</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4ac789e90eead3612a24114b9eae58fdec">CCopasiMessage::WARNING</a>, <span class="stringliteral">&quot;maximum number of reaction events was reached in at least one simulation step.\nThat means time intervals in the output may not be what you requested.&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// get back the particle numbers</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">/* Set the variable metabolites */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> * Dbl = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a15e3647f764be63737bdaf898299ef18">beginIndependent</a>() + <a class="code" href="../../d5/da3/classCHybridMethod.html#a4c23a4b88ac80dd5070c55028fdafe7f">mFirstMetabIndex</a> - 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">for</span> (i = 0, imax = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#ab917cbb21d517aaa490416066d57ebb0">getNumVariableMetabs</a>(); i &lt; imax; i++, Dbl++)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    *Dbl = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>()[i]-&gt;getValue();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#ab3518ff2426cb53acd8f96cd73abaa4fab89a8c9ac9789a8cc1fb9f56ae571eb1">NORMAL</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ab9af5950130324681a6468cb8397c771">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ab9af5950130324681a6468cb8397c771">CHybridMethod::start</a>(<span class="keyword">const</span> <a class="code" href="../../dc/d1d/classCState.html">CState</a> * initialState)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  *<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a> = *initialState;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a> = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  assert(<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#aceafaf1b517c3b0fd1989c1004d669f7">getModelType</a>() == <a class="code" href="../../d4/d04/classCModel.html#a607d468405aace77f2181ef72c73435ca852877a1fa93e102c671cc015189d7bb">CModel::deterministic</a>)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="../../d5/da3/classCHybridMethod.html#a9802043e8d3ed10063502e4513ae2335">mDoCorrection</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="../../d5/da3/classCHybridMethod.html#a9802043e8d3ed10063502e4513ae2335">mDoCorrection</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a191785e3885c114a1d6d7c18267b50d4">mHasAssignments</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a74dd307cee2fecfcfc19032be5446521">modelHasAssignments</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4c23a4b88ac80dd5070c55028fdafe7f">mFirstMetabIndex</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#acfb4df497a8bab1bdde3d275c37fa2d5">getStateTemplate</a>().<a class="code" href="../../d7/dc0/classCStateTemplate.html#a560610b4966dbc401d69f9f32a2c3bdb">getIndex</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>()[0]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">mpProblem</a>-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a4f2900711f3da1980a14ac2617581820">setState</a>(*<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7c6e6e91ffe791d367e0a32ba5602014">updateSimulatedValues</a>(<span class="keyword">false</span>); <span class="comment">//for assignments</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//mpModel-&gt;updateNonSimulatedValues(); //for assignments</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// call init of the simulation method, can be overloaded in derived classes</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aae947d02310b4078666a67ae1b709861">initMethod</a>(<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/* PROTECTED METHODS *********************************************************/</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> *  Initializes the solver and sets the model to be used.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> *  @param model A reference to an instance of a CModel</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#aae947d02310b4078666a67ae1b709861">  264</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#aae947d02310b4078666a67ae1b709861">CHybridMethod::initMethod</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> start_time)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#ad9a3dc1905f1f38f689f728b829f285d">getReactions</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>.clear();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>.clear();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a> = &amp;(const_cast &lt; <a class="code" href="../../d8/d2c/classCCopasiVector.html">CCopasiVector &lt; CMetab &gt;</a> &amp; &gt;(<a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>()));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">//mNumVariableMetabs = mpModel-&gt;getNumVariableMetabs(); // ind + dep metabs, without fixed metabs</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a0953a21acfd7376debc68787923bbe74">getNumIndependentReactionMetabs</a>() + <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#afd44438ad6fc4bdd5f2ef6a7fc7993bb">getNumDependentReactionMetabs</a>(); <span class="comment">// ind + dep metabs, without fixed metabs</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">//  mNumVariableMetabs = mpCurrentState-&gt;getNumVariable(); // mpBeginFixed - mpBeginIndependent</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>.clear();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>.clear();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>.clear();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>.clear();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>.clear();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>.clear();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">/* get configuration data */</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">mMaxSteps</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Max Internal Steps&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a50d26400fb0795a03ef6979f6a61f777">pINT</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Lower Limit&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Upper Limit&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Runge Kutta Stepsize&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a714f98c445d63eb279481e1f010b59bd">mPartitioningInterval</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Partitioning Interval&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#aff3513fc28ecdd68e86a60f5df54816b">pUINT</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a539f9b2f02b1db99e4533354d9228647">mUseRandomSeed</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Use Random Seed&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a8c94ab18ba3f3a90c861b5a86852a39e">pBOOL</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a8f732c6c0cd0c5fffe6b40674fa24f49">mRandomSeed</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Random Seed&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#aff3513fc28ecdd68e86a60f5df54816b">pUINT</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a539f9b2f02b1db99e4533354d9228647">mUseRandomSeed</a>) <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a>-&gt;<a class="code" href="../../df/dcb/classCRandom.html#a4c60adfc235ed3a9ab82ba7427f6d35f">initialize</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#a8f732c6c0cd0c5fffe6b40674fa24f49">mRandomSeed</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a12ea59078191e453908df685b7b2551f">getStoi</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aa2568cf74b74743d5c93f5b417adbf0c">mStepsAfterPartitionSystem</a> = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.clear();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a3b97c783a23bdba910a59b475a49111e">setupBalances</a>(); <span class="comment">// initialize mLocalBalances and mLocalSubstrates (has to be called first!)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a54edfed11a96ec6a1ae976adbe4217d2">setupDependencyGraph</a>(); <span class="comment">// initialize mDG</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a32b90a7983cd6161e023821baa81a64d">setupMetab2React</a>(); <span class="comment">// initialize mMetab2React</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a5b09e2f1e7ff2d4db84388a5aa2d20bb">setupPartition</a>(); <span class="comment">// initialize mReactionFlags</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#af954f8e3d7e6e720825222c55bbf3a99">setupPriorityQueue</a>(start_time); <span class="comment">// initialize mPQ</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4cd08c91c12fe261a45100465b521ad0">mMaxStepsReached</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> *  Cleans up memory, etc.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a2f841429c7a79c2695aa696ac5820884">  319</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a2f841429c7a79c2695aa696ac5820884">CHybridMethod::cleanup</a>()</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keyword">delete</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a> = NULL;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a> = NULL;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">/* DETERMINISTIC STUFF *******************************************************/</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> *   Integrates the deterministic reactions of the system over the specified</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> *   time interval.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"> *   @param ds A C_FLOAT64 specifying the stepsize.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ad6d222058285ccaef769ec39d0973c5d">  335</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ad6d222058285ccaef769ec39d0973c5d">CHybridMethod::integrateDeterministicPart</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> dt)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;{</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> integrationTime = 0.0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a> * react = NULL;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// This method uses a 4th order RungeKutta-method to integrate the deterministic part of the system. Maybe a better numerical method (adaptive stepsize, lsoda, ...) should be introduced here later on</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">while</span> ((dt - integrationTime) &gt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#ae9b58bea04f43b2b2cac1ca5b039beed">rungeKutta</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>); <span class="comment">// for the deterministic part of the system</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      integrationTime += <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ae9b58bea04f43b2b2cac1ca5b039beed">rungeKutta</a>(dt - integrationTime);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// find the set union of all reactions, which depend on one of the deterministic reactions. The propensities of the stochastic reactions in this set union will be updated later in the method updatePriorityQueue().</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">for</span> (react = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>; react != NULL; react = react-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keyword">const</span> std::set &lt;size_t&gt; &amp; dependents = <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>.<a class="code" href="../../da/da0/classCDependencyGraph.html#a8f084d356c98ede0514d96cf91239f9f">getDependents</a>(react-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      std::copy(dependents.begin(), dependents.end(),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                std::inserter(<a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>, <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin()));</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> *   Integrates the deterministic reactions of the system over the specified</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> *   time interval.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> *   @param ds A C_FLOAT64 specifying the stepsize.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ac774b53601a49a5d158fc4274fb9ac84">  367</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ac774b53601a49a5d158fc4274fb9ac84">CHybridMethod::integrateDeterministicPartEuler</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> dt)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> integrationTime = 0.0;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a> * react = NULL;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">while</span> ((dt - integrationTime) &gt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">getState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i] + (<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      integrationTime += <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">getState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i] + (<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * (dt - integrationTime));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// find the set union of all reactions, which depend on one of the deterministic reactions. The propensities of the stochastic reactions in this set union will be updated later in the method updatePriorityQueue().</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">for</span> (react = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>; react != NULL; react = react-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a>)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keyword">const</span> std::set &lt;size_t&gt; &amp; dependents = <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>.<a class="code" href="../../da/da0/classCDependencyGraph.html#a8f084d356c98ede0514d96cf91239f9f">getDependents</a>(react-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      std::copy(dependents.begin(), dependents.end(),</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                std::inserter(<a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>, <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin()));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"> *   Does one 4th order RungeKutta step to integrate the system</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"> *   numerically.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> *   @param dt A C_FLOAT64 specifying the stepsize</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> *   @param result A reference to a vector, into which the result, that is</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> *                 the increment vector, will be written</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ae9b58bea04f43b2b2cac1ca5b039beed">  412</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ae9b58bea04f43b2b2cac1ca5b039beed">CHybridMethod::rungeKutta</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> dt)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">/* save current state */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">getState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">/* k1 step: k1 = dt*f(x(n)) */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>); <span class="comment">// systemState == x(n)</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * dt;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">/* k2 step: k2 = dt*f(x(n) + k1/2) */</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>[i] / 2.0 + <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>); <span class="comment">// systemState == x(n) + k1/2</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * dt;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">/* k3 step: k3 = dt*f(x(n) + k2/2) */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>[i] / 2.0 + <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>); <span class="comment">// systemState == x(n) + k2/2</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * dt;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">/* k4 step: k4 = dt*f(x(n) + k3); */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>[i] + <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">calculateDerivative</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>); <span class="comment">// systemState == x(n) + k3</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] * dt;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">/* Find next position: x(n+1) = x(n) + 1/6*(k1 + 2*k2 + 2*k3 + k4)  */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i] + (1.0 / 6.0) * (<a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>[i] + 2.0 * <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>[i] + 2.0 * <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>[i] + <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>[i]);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">setState</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> *   Calculates the derivative of the system and writes it into the vector</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"> *   deriv. Length of deriv must be mNumVariableMetabs.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"> *   CAUTION: Only deterministic reactions are taken into account. That is,</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"> *   this is only the derivative of the deterministic part of the system.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"> *   @param deriv A vector reference of length mNumVariableMetabs, into</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> *                which the derivative is written</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">  489</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">CHybridMethod::calculateDerivative</a>(std::vector &lt;C_FLOAT64&gt; &amp; deriv)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> bal = 0;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a> * j;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Calculate all the needed kinetic functions of the deterministic reactions</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">for</span> (j = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>; j != NULL; j = j-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a>)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      (*mpReactions)[j-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a>]-&gt;calculateParticleFlux();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// For each metabolite add up the contributions of the det. reactions</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// the number of rows in mStoi equals the number of non-fixed metabolites!</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">//  for (i=0; i&lt;mNumVariableMetabs; i++)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a>.<a class="code" href="../../d7/dd7/classCMatrix.html#a89c31fa3d2bc0945143171ca39756c74">numRows</a>(); i++)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      deriv[i] = 0.0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">for</span> (j = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>; j != NULL; j = j-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a>)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          <span class="comment">// juergen: +0.5 to get a rounding out of the static_cast</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;          bal = <span class="keyword">static_cast&lt;</span> <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> <span class="keyword">&gt;</span>(floor(<a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a>[i][j-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a>] + 0.5));</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;          deriv[i] += bal * (*mpReactions)[j-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a>]-&gt;getParticleFlux(); <span class="comment">//  balance * flux;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">    for (; i &lt; mNumVariableMetabs; i++) deriv[i] = 0.0; // important to get a correct deriv vector, because mStoi doesn&#39;t cover fixed metabolites</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"> *   Gathers the state of the system into the array target. Later on CState</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"> *   should be used for this. Length of the array target must be mNumVariableMetabs.</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"> *   @param target An array of C_FLOAT64s with length mNumVariableMetabs, into which the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"> *                 state of the system is written</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">  529</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">CHybridMethod::getState</a>(std::vector &lt;C_FLOAT64&gt; &amp; target)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;{</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      target[i] = (*mpMetabolites)[i]-&gt;getValue();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"> *   Writes the state specified in the vector source into the model.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"> *   Length of the vector source must be mNumVariableMetabs.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"> *   (Number of non-fixed metabolites in the model).</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"> *   @param source A vector reference with length mNumVariableMetabs,</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"> *                 holding the state of the system to be set in the model</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">  549</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">CHybridMethod::setState</a>(std::vector &lt;C_FLOAT64&gt; &amp; source)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;{</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      (*mpMetabolites)[i]-&gt;setValue(source[i]);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      (*mpMetabolites)[i]-&gt;refreshConcentration();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7c6e6e91ffe791d367e0a32ba5602014">updateSimulatedValues</a>(<span class="keyword">false</span>); <span class="comment">//for assignments</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">/* STOCHASTIC STUFF **********************************************************/</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> *   Find the reaction index and the reaction time of the stochastic (!)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"> *   reaction with the lowest reaction time.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> *   @param ds A reference to a C_FLOAT64. The putative reaction time for the</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"> *             first stochastic reaction is written into this variable.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> *   @param rIndex A reference to a size_t. The index of the first</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> *                 stochastic reaction is written into this variable.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ac3f14c7f4bba32eacb0c4adf2e8c160a">  574</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ac3f14c7f4bba32eacb0c4adf2e8c160a">CHybridMethod::getStochTimeAndIndex</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> &amp; ds, <span class="keywordtype">size_t</span> &amp; rIndex)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;{</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  ds = <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#aadd0b9793aacfebce6c6f01fb8d7ef5e">topKey</a>();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  rIndex = <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#ac2eff921e71ef8fe991002bde5fe1d6e">topIndex</a>();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"> *   Executes the specified reaction in the system once.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"> *   @param rIndex A size_t specifying the index of the reaction, which</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"> *                 will be fired.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"> *   @param time   The current time</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a40a046d84dd6fd877d3846caedc5bb4a">  588</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a40a046d84dd6fd877d3846caedc5bb4a">CHybridMethod::fireReaction</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// Change the particle numbers according to which step took place.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// First, get the vector of balances in the reaction we&#39;ve got.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// (This vector expresses the number change of each metabolite</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// in the reaction.) Then step through each balance, using its</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// multiplicity to calculate a new value for the associated</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// metabolite. Finally, update the metabolite.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> newNumber;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="../../dc/d44/classCMetab.html">CMetab</a> * pMetab;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex].size(); i++)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      pMetab = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex][i].mpMetabolite;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      newNumber = pMetab-&gt;<a class="code" href="../../d0/da0/classCModelEntity.html#ac411005efc9db817150b2bd95303d53c">getValue</a>() + <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex][i].mMultiplicity;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      pMetab-&gt;<a class="code" href="../../d0/da0/classCModelEntity.html#a46635849ce0741538dc390f682571738">setValue</a>(newNumber);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      pMetab-&gt;<a class="code" href="../../dc/d44/classCMetab.html#aefdb588dfa4f688ec4fe63e9486ff760">refreshConcentration</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// insert all dependent reactions into the mUpdateSet</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keyword">const</span> std::set &lt;size_t&gt; &amp; dependents = <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>.<a class="code" href="../../da/da0/classCDependencyGraph.html#a8f084d356c98ede0514d96cf91239f9f">getDependents</a>(rIndex);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  std::copy(dependents.begin(), dependents.end(),</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            std::inserter(<a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>, <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin()));</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"> *   Updates the priority queue.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"> *   @param rIndex A size_t giving the index of the fired reaction (-1, if no</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment"> *                 stochastic reaction has fired)</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"> *   @param time A C_FLOAT64 holding the current time</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a884b2a01f42003ecfaa8bc8838ae8e19">  625</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a884b2a01f42003ecfaa8bc8838ae8e19">CHybridMethod::updatePriorityQueue</a>(<span class="keywordtype">size_t</span> rIndex, <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> time)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;{</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> newTime;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordtype">size_t</span> index;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  std::set &lt;size_t&gt;::iterator iter, iterEnd;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">//if the model contains assignments we use a less efficient loop over all (stochastic) reactions to capture all changes</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// we do not know the exact dependencies. TODO: this should be changed later in order to get a more efficient update scheme</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a191785e3885c114a1d6d7c18267b50d4">mHasAssignments</a>)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7c6e6e91ffe791d367e0a32ba5602014">updateSimulatedValues</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); index++)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[index].mpPrev == NULL) <span class="comment">// Reaction is stochastic!</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[index] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[index];</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">calculateAmu</a>(index);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[index] != <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[index])</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="keywordflow">if</span> (index != rIndex) <a class="code" href="../../d5/da3/classCHybridMethod.html#a4750addb2803c82833260aa406148950">updateTauMu</a>(index, time);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="comment">// iterate through the set of affected reactions and update the stochastic ones in the priority queue</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.end(); iter != iterEnd; iter++)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[*iter].mpPrev == NULL) <span class="comment">// reaction is stochastic!</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;              index = *iter;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[index] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[index];</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">calculateAmu</a>(index);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;              <span class="keywordflow">if</span> (*iter != rIndex) <a class="code" href="../../d5/da3/classCHybridMethod.html#a4750addb2803c82833260aa406148950">updateTauMu</a>(index, time);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// draw new random number and update the reaction just fired</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">if</span> ((rIndex != <a class="code" href="../../dc/df8/copasi_8h.html#aa623c2be2264b57fb3953a22ac74a470">C_INVALID_INDEX</a>) &amp;&amp; (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev == NULL))</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="comment">// reaction is stochastic</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      newTime = time + <a class="code" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">generateReactionTime</a>(rIndex);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#af35ebf85f77fdad1e197dea8495f2d2c">updateNode</a>(rIndex, newTime);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// empty the mUpdateSet</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.clear();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">  678</a></span>&#160;<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> <a class="code" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">CHybridMethod::generateReactionTime</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;{</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] == 0) <span class="keywordflow">return</span> std::numeric_limits&lt;C_FLOAT64&gt;::infinity();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> rand2 = <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a>-&gt;<a class="code" href="../../df/dcb/classCRandom.html#a410b37bfff992d5d2b30fd4cb635a0e0">getRandomOO</a>();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">return</span> - 1 * log(rand2) / <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex];</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> *   Calculates an amu value for a given reaction.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> *   @param rIndex A size_t specifying the reaction to be updated</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">  691</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">CHybridMethod::calculateAmu</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;{</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da3/classCHybridMethod.html#a9802043e8d3ed10063502e4513ae2335">mDoCorrection</a>)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] = (*mpReactions)[rIndex]-&gt;calculateParticleFlux();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">// We need the product of the cmu and hmu for this step.</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// We calculate this in one go, as there are fewer steps to</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// perform and we eliminate some possible rounding errors.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> amu = 1; <span class="comment">// initially</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">//size_t total_substrates = 0;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> num_ident = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ab51793927eb923d40cd2161bbbe98b7d">C_INT64</a> number = 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ab51793927eb923d40cd2161bbbe98b7d">C_INT64</a> lower_bound;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// substrate_factor - The substrates, raised to their multiplicities,</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">// multiplied with one another. If there are, e.g. m substrates of type m,</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// and n of type N, then substrate_factor = M^m * N^n.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> substrate_factor = 1;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// First, find the reaction associated with this index.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// Keep a pointer to this.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// Iterate through each substrate in the reaction</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keyword">const</span> std::vector&lt;CHybridBalance&gt; &amp; substrates = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>[rIndex];</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a> = 0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; substrates.size(); i++)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      num_ident = substrates[i].mMultiplicity;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">if</span> (num_ident &gt; 1)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          flag = 1;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          number = <span class="keyword">static_cast&lt;</span><a class="code" href="../../dc/df8/copasi_8h.html#ab51793927eb923d40cd2161bbbe98b7d">C_INT64</a><span class="keyword">&gt;</span>(floor((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[substrates[i].mIndex]-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>()));</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          lower_bound = number - num_ident;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          substrate_factor = substrate_factor * pow((<span class="keywordtype">double</span>) number, (<span class="keywordtype">int</span>) num_ident - 1); <span class="comment">//optimization</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          number--; <span class="comment">// optimization</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          <span class="keywordflow">while</span> (number &gt; lower_bound)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              amu *= number;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              number--;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">if</span> ((amu == 0) || (substrate_factor == 0))  <span class="comment">// at least one substrate particle number is zero</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] = 0;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">// rate_factor is the rate function divided by substrate_factor.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// It would be more efficient if this was generated directly, since in effect we</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// are multiplying and then dividing by the same thing (substrate_factor)!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> rate_factor = (*mpReactions)[rIndex]-&gt;calculateParticleFlux();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      amu *= rate_factor / substrate_factor;;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] = amu;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] = rate_factor;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="comment">// a more efficient way to calculate mass action kinetics could be included</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"> *   Updates the putative reaction time of a stochastic reaction in the</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"> *   priority queue. The corresponding amu and amu_old must be set prior to</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment"> *   the call of this method.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"> *   @param rIndex A size_t specifying the index of the reaction</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a4750addb2803c82833260aa406148950">  772</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a4750addb2803c82833260aa406148950">CHybridMethod::updateTauMu</a>(<span class="keywordtype">size_t</span> rIndex, <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> time)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> newTime;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// One must make sure that the calculation yields reasonable results even in the cases where mAmu=0 or mAmuOld=0 or both =0. Therefore mAmuOld=0 is checked. If mAmuOld equals 0, then a new random number has to be drawn, because tau equals inf and the stoch. information is lost. If both values equal 0, then tau should remain inf and the update of the queue can be skipped!</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[rIndex] == 0.0)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] != 0.0)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          newTime = time + <a class="code" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">generateReactionTime</a>(rIndex);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#af35ebf85f77fdad1e197dea8495f2d2c">updateNode</a>(rIndex, newTime);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      newTime = time + (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[rIndex] / <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex]) * (<a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#acc438462395ab9af5cb4bdb2340d44a5">getKey</a>(rIndex) - time);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#af35ebf85f77fdad1e197dea8495f2d2c">updateNode</a>(rIndex, newTime);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">/* TESTING THE MODEL AND SETTING UP THINGS ***********************************/</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> *   Test the model if it is proper to perform stochastic simulations on.</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> *   Several properties are tested (e.g. integer stoichometry, all reactions</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> *   take place in one compartment only, irreversibility...).</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"> *   @return 0, if everything is ok; &lt;0, if an error occured.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00804"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#aaf7114f8bd3fb9314ddd9244197fada0">  804</a></span>&#160;<a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> <a class="code" href="../../d5/da3/classCHybridMethod.html#aaf7114f8bd3fb9314ddd9244197fada0">CHybridMethod::checkModel</a>(<a class="code" href="../../d4/d04/classCModel.html">CModel</a> * model)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;{</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <a class="code" href="../../d9/db9/classCCopasiVectorNS.html">CCopasiVectorNS &lt;CReaction&gt;</a> * <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a> = &amp;model-&gt;<a class="code" href="../../d4/d04/classCModel.html#ad9a3dc1905f1f38f689f728b829f285d">getReactions</a>();</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="../../d7/dd7/classCMatrix.html">CMatrix &lt;C_FLOAT64&gt;</a> <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a> = model-&gt;<a class="code" href="../../d4/d04/classCModel.html#a12ea59078191e453908df685b7b2551f">getStoi</a>();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordtype">size_t</span> i, numReactions = mpReactions-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordtype">size_t</span> j;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> multInt;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> multFloat;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">//  size_t metabSize = mpMetabolites-&gt;size();</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++) <span class="comment">// for every reaction</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="comment">// TEST getCompartmentNumber() == 1</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">if</span> ((*mpReactions)[i]-&gt;getCompartmentNumber() != 1) <span class="keywordflow">return</span> - 1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">// TEST isReversible() == 0</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">if</span> ((*mpReactions)[i]-&gt;isReversible() != 0) <span class="keywordflow">return</span> - 2;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="comment">// TEST integer stoichometry</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="comment">// Iterate through each the metabolites</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="comment">// juergen: the number of rows of mStoi equals the number of non-fixed metabs!</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="comment">//  for (j=0; i&lt;metabSize; j++)</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; mStoi.<a class="code" href="../../d7/dd7/classCMatrix.html#a89c31fa3d2bc0945143171ca39756c74">numRows</a>(); j++)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;          multFloat = mStoi[j][i];</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          multInt = <span class="keyword">static_cast&lt;</span><a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a><span class="keyword">&gt;</span>(floor(multFloat + 0.5)); <span class="comment">// +0.5 to get a rounding out of the static_cast to int!</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          <span class="keywordflow">if</span> ((multFloat - multInt) &gt; <a class="code" href="../../d2/dda/CHybridMethod_8h.html#aba6eb8a6ee596d44eea3e071940e7863">INT_EPSILON</a>) <span class="keywordflow">return</span> - 3; <span class="comment">// INT_EPSILON in CHybridMethod.h</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">return</span> 1; <span class="comment">// Model is appropriate for hybrid simulation</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> *   Sets up an internal representation of the balances for each reaction.</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"> *   This is done in order to be able to deal with fixed metabolites and</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment"> *   to avoid a time consuming search for the indices of metabolites in the</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment"> *   model.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00845"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a3b97c783a23bdba910a59b475a49111e">  845</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a3b97c783a23bdba910a59b475a49111e">CHybridMethod::setupBalances</a>()</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;{</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <a class="code" href="../../d0/df3/classCHybridBalance.html">CHybridBalance</a> newElement;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> maxBalance = 0;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordtype">size_t</span> numReactions;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  numReactions = <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.clear();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.resize(numReactions);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>.clear();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>.resize(numReactions);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../d8/d2c/classCCopasiVector.html">CCopasiVector &lt;CChemEqElement&gt;</a> * balances =</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        &amp;(*mpReactions)[i]-&gt;getChemEq().getBalances();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; balances-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); j++)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a> = const_cast &lt; <a class="code" href="../../dc/d44/classCMetab.html">CMetab</a>* &gt;((*balances)[j]-&gt;getMetabolite());</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a5ec7ce44f5035e78eeb1aee43b620f4d">mIndex</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>().<a class="code" href="../../d8/d2c/classCCopasiVector.html#a8c53303b8661506a7de88a154699b234">getIndex</a>(newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="comment">// + 0.5 to get a rounding out of the static_cast to size_t!</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">mMultiplicity</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a><span class="keyword">&gt;</span>(floor((*balances)[j]-&gt;getMultiplicity() + 0.5));</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">if</span> ((newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a>-&gt;<a class="code" href="../../d0/da0/classCModelEntity.html#ad6bdcaa2e8887271f61fc363262cc9ed">getStatus</a>()) != <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa8751c35af95ea9346908d9835a1b0570">CModelEntity::FIXED</a>)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;              <span class="keywordflow">if</span> (newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">mMultiplicity</a> &gt; maxBalance) maxBalance = newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">mMultiplicity</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i].push_back(newElement); <span class="comment">// element is copied for the push_back</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      balances = &amp;(*mpReactions)[i]-&gt;getChemEq().getSubstrates();</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; balances-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); j++)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a> = const_cast &lt; <a class="code" href="../../dc/d44/classCMetab.html">CMetab</a>* &gt;((*balances)[j]-&gt;getMetabolite());</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a5ec7ce44f5035e78eeb1aee43b620f4d">mIndex</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">mpModel</a>-&gt;<a class="code" href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">getMetabolitesX</a>().<a class="code" href="../../d8/d2c/classCCopasiVector.html#a8c53303b8661506a7de88a154699b234">getIndex</a>(newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          <span class="comment">// + 0.5 to get a rounding out of the static_cast to size_t!</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          newElement.<a class="code" href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">mMultiplicity</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a><span class="keyword">&gt;</span>(floor((*balances)[j]-&gt;getMultiplicity() + 0.5));</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>[i].push_back(newElement); <span class="comment">// element is copied for the push_back</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ae670bae6641b50da8038105c44b5f225">mMaxBalance</a> = maxBalance;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a203f66c74160cf0c70da56c6773979fc">mMaxIntBeforeStep</a> = INT_MAX - 1 - <a class="code" href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">mMaxSteps</a> * <a class="code" href="../../d5/da3/classCHybridMethod.html#ae670bae6641b50da8038105c44b5f225">mMaxBalance</a>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"> *   Sets up the dependency graph.</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00900"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a54edfed11a96ec6a1ae976adbe4217d2">  900</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a54edfed11a96ec6a1ae976adbe4217d2">CHybridMethod::setupDependencyGraph</a>()</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;{</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>.<a class="code" href="../../da/da0/classCDependencyGraph.html#a4e48c4064d234e1aa75d795849e7c250">clear</a>();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  std::vector&lt; std::set&lt;std::string&gt;* &gt; DependsOn;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  std::vector&lt; std::set&lt;std::string&gt;* &gt; Affects;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordtype">size_t</span> numReactions = <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// Do for each reaction:</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="comment">// Get the set of metabolites  which affect the value of amu for this</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="comment">// reaction i.e. the set on which amu depends. This may be  more than</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="comment">// the set of substrates, since the kinetics can involve other</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="comment">// reactants, e.g. catalysts. We thus need to step through the</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="comment">// rate function and pick out every reactant which can vary.</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      DependsOn.push_back(<a class="code" href="../../d5/da3/classCHybridMethod.html#a7c1ee0898371a0af8c38f24fb4fd991e">getDependsOn</a>(i));</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="comment">// Get the set of metabolites which are affected when this reaction takes place</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      Affects.push_back(<a class="code" href="../../d5/da3/classCHybridMethod.html#ad2031dcea4dcecae4ab4c8f26aa9857f">getAffects</a>(i));</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">// For each possible pair of reactions i and j, if the intersection of</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">// Affects(i) with DependsOn(j) is non-empty, add a dependency edge from i to j.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; numReactions; j++)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          <span class="comment">// Determine whether the intersection of these two sets is non-empty</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;          <span class="comment">// Could also do this with set_intersection generic algorithm, but that</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          <span class="comment">// would require operator&lt;() to be defined on the set elements.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          std::set&lt;std::string&gt;::iterator iter = Affects[i]-&gt;begin();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          <span class="keywordflow">for</span> (; iter != Affects[i]-&gt;end(); iter++)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;              <span class="keywordflow">if</span> (DependsOn[j]-&gt;count(*iter))</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                  <span class="comment">// The set intersection is non-empty</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>.<a class="code" href="../../da/da0/classCDependencyGraph.html#abe79ef02c78a79c68b1f691ba4ee5c8c">addDependent</a>(i, j);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// Ensure that self edges are included</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="comment">//mDG.addDependent(i, i);</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// Delete the memory allocated in getDependsOn() and getAffects()</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// since this is allocated in other functions.</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keyword">delete</span> DependsOn[i];</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keyword">delete</span> Affects[i];</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment"> *   Creates for each metabolite a set of reaction indices. If the metabolite</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment"> *   participates in a reaction as substrate or product (that means:</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment"> *   balance != 0) this reaction is added to the corresponding set.</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a32b90a7983cd6161e023821baa81a64d">  964</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a32b90a7983cd6161e023821baa81a64d">CHybridMethod::setupMetab2React</a>()</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;{</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordtype">size_t</span> metaboliteIndex;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">// Resize mMetab2React and create an initial set for each metabolite</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>.clear();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// Iterate over all reactions</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// Get the set of metabolites which take part in this reaction</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i].size(); j++)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;          <span class="comment">// find metaboliteIndex and insert the reaction into the set</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          metaboliteIndex = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i][j].mIndex;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[metaboliteIndex].insert(i);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;}</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"> *   Creates for each metabolite a set of reaction indices. If the metabolite</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"> *   participates in a reaction as substrate, product or modifier this</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"> *   reaction is added to the corresponding set.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00993"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a0939454d0b62bd29c0414ded979f4341">  993</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a0939454d0b62bd29c0414ded979f4341">CHybridMethod::setupMetab2ReactPlusModifier</a>()</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;{</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  std::vector&lt; std::set&lt;size_t&gt;* &gt; participatesIn;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordtype">size_t</span> numReactions = <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// Resize mMetab2React and create an initial set for each metabolite</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// Do for each reaction:</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      participatesIn.push_back(<a class="code" href="../../d5/da3/classCHybridMethod.html#af96f8154e8ea63a72705b9ba812c49b9">getParticipatesIn</a>(i));</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">// Iterate over all reactions</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="comment">// Get the set of metabolites which take part in this reaction</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      std::set&lt;size_t&gt;::iterator iter = participatesIn[i]-&gt;begin();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">for</span> (; iter != participatesIn[i]-&gt;end(); iter++)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[*iter].insert(i);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; numReactions; i++)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keyword">delete</span> participatesIn[i];</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"> *   Creates for each metabolite a set of reaction indices. Each reaction is</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment"> *   dependent on each metabolite resulting in a complete switch.</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a5ffffbe81b45fa2031bde3dcb7ec0bf8"> 1030</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a5ffffbe81b45fa2031bde3dcb7ec0bf8">CHybridMethod::setupMetab2ReactComplete</a>()</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// Resize mMetab2React and create an initial set for each metabolite</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">// Iterate over all metabolites</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">// Iterate over all reactions</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); j++)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].insert(j);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;}</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment"> *   Creates an initial partitioning of the system. Deterministic and</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment"> *   stochastic reactions are determined. The vector mReactionFlags and</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment"> *   the vector mMetabFlags are initialized.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a5b09e2f1e7ff2d4db84388a5aa2d20bb"> 1055</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a5b09e2f1e7ff2d4db84388a5aa2d20bb">CHybridMethod::setupPartition</a>()</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;{</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <a class="code" href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a> * prevFlag;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> averageStochLimit = (<a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a> + <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a>) / 2;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="comment">// initialize vector mMetabFlags</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>.clear();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>.size(); i++)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keywordflow">if</span> ((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i]-&gt;getValue() &lt; averageStochLimit)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          (*mpMetabolites)[i]-&gt;setValue(floor((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i]-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>()));</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          (*mpMetabolites)[i]-&gt;refreshConcentration();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fab7c8746f90bec501424c815ccbf5c6c2">HIGH</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">// initialize vector mReactionFlags</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>.clear();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>.resize(<a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size());</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mIndex = i;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mValue = 0;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i].size(); j++)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[<a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i][j].mIndex] == <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mValue++;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = NULL;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  prevFlag = NULL;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].<a class="code" href="../../d5/db6/classCCopasiParameter.html#af7c874dee22c599e9298e41619171b3f">mValue</a> == 0)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> != NULL)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;              prevFlag-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mpPrev = prevFlag;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;              prevFlag = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mpPrev = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i]; <span class="comment">// Important to distinguish between stochastic (prev == NULL) and deterministic (prev != NULL) reactions</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;              prevFlag = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mpPrev = NULL;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mpNext = NULL;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">if</span> (prevFlag != NULL)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      prevFlag-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a> = NULL;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment"> *   Sets up the priority queue.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment"> *   @param startTime The time at which the simulation starts.</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#af954f8e3d7e6e720825222c55bbf3a99"> 1135</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#af954f8e3d7e6e720825222c55bbf3a99">CHybridMethod::setupPriorityQueue</a>(<a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> startTime)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;{</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> time;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#a122816d215f833f8b004cc48c240a398">clear</a>();</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#aad3af2a0fa4684262ec4c4049a3e059e">initializeIndexPointer</a>(<a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>());</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i].mpPrev == NULL) <span class="comment">// Reaction is stochastic!</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">calculateAmu</a>(i);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          time = startTime + <a class="code" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">generateReactionTime</a>(i);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#a8bbac1ce28fa03f30ccd84e281534e18">insertStochReaction</a>(i, time);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;}</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">/* HELPER METHODS ************************************************************/</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment"> *   Updates the partitioning of the system depending on the particle</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment"> *   numbers present.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a8eb82ec01cfc4e05f558af5bd809314c"> 1162</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a8eb82ec01cfc4e05f558af5bd809314c">CHybridMethod::partitionSystem</a>()</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;{</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  std::set &lt;size_t&gt;::iterator iter, iterEnd;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a> key;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] == <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>) &amp;&amp; ((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i]-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>() &gt;= <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a>))</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fab7c8746f90bec501424c815ccbf5c6c2">HIGH</a>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          <span class="comment">// go through all corresponding reactions and update flags</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].end(); iter != iterEnd; iter++)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[*iter].mValue--;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;              <span class="comment">// if reaction gets deterministic, insert it into the linked list of deterministic reactions</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[*iter].<a class="code" href="../../d5/db6/classCCopasiParameter.html#af7c874dee22c599e9298e41619171b3f">mValue</a> == 0)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#a8913fe8f85a708defe69441a93bd81f9">insertDeterministicReaction</a>(*iter);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#a32da70ad484168c4bd928cc847897c3e">removeStochReaction</a>(*iter);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] == <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fab7c8746f90bec501424c815ccbf5c6c2">HIGH</a>) &amp;&amp; ((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i]-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>() &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a>))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          (*mpMetabolites)[i]-&gt;setValue(floor((*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i]-&gt;<a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>()));</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;          (*mpMetabolites)[i]-&gt;refreshConcentration();</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          <span class="comment">// go through all corresponding reactions and update flags</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].end(); iter != iterEnd; iter++)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[*iter].<a class="code" href="../../d5/db6/classCCopasiParameter.html#af7c874dee22c599e9298e41619171b3f">mValue</a> == 0)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#ab2c68ba9951c4ee5e6b33599a20b2404">removeDeterministicReaction</a>(*iter);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                  <span class="comment">/*</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">                    mPQ.insertStochReaction(*iter, 1234567.8);  // juergen: have to beautify this, number has to be the biggest C_FLOAT64 !!!</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">                  */</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">calculateAmu</a>(*iter);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[*iter] = <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[*iter];</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                  key = <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>() + <a class="code" href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">generateReactionTime</a>(*iter);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                  <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>.<a class="code" href="../../d6/db8/classCIndexedPriorityQueue.html#a8bbac1ce28fa03f30ccd84e281534e18">insertStochReaction</a>(*iter, key);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[*iter].mValue++;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;}</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment"> *   Inserts a new deterministic reaction into the linked list in the</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment"> *   array mReactionFlags.</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"> *   @param rIndex A size_t giving the index of the reaction to be inserted</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"> *                 into the list of deterministic reactions.</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a8913fe8f85a708defe69441a93bd81f9"> 1224</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a8913fe8f85a708defe69441a93bd81f9">CHybridMethod::insertDeterministicReaction</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;{</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev == NULL)</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// reaction is stochastic (avoids double insertions)</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> != NULL)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="comment">// there are deterministic reactions already</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex];</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex];</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          <span class="comment">// there are no deterministic reactions</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;          <span class="comment">// Important to distinguish between stochastic (prev == NULL) and deterministic (prev != NULL) reactions</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex];</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = &amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex];</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[rIndex] = 0.0;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[rIndex] = 0.0;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"> *   Removes a deterministic reaction from the linked list in the</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment"> *   array mReactionFlags.</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"> *   @param rIndex A size_t giving the index of the reaction to be removed</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment"> *                 from the list of deterministic reactions.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ab2c68ba9951c4ee5e6b33599a20b2404"> 1259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#ab2c68ba9951c4ee5e6b33599a20b2404">CHybridMethod::removeDeterministicReaction</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;{</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev != NULL)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">// reaction is deterministic</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keywordflow">if</span> (&amp;<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex] != <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="comment">// reactionFlag is not the first in the linked list</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev-&gt;mpNext = <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext != NULL)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext-&gt;mpPrev = <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">// reactionFlag is the first in the linked list</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext != NULL) <span class="comment">// reactionFlag is not the only one in the linked list</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a> = <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// reactionFlag is the only one in the linked list</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;              <a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> = NULL;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpPrev = NULL;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[rIndex].mpNext = NULL;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;}</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment"> *   Gets the set of metabolites on which a given reaction depends.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment"> *   @param rIndex The index of the reaction being executed.</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment"> *   @return The set of metabolites depended on.</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a7c1ee0898371a0af8c38f24fb4fd991e"> 1298</a></span>&#160;std::set&lt;std::string&gt; *<a class="code" href="../../d5/da3/classCHybridMethod.html#a7c1ee0898371a0af8c38f24fb4fd991e">CHybridMethod::getDependsOn</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;{</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  std::set&lt;std::string&gt; *retset = <span class="keyword">new</span> std::set&lt;std::string&gt;;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keywordtype">size_t</span> i, imax = (*mpReactions)[rIndex]-&gt;getFunctionParameters().size();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordtype">size_t</span> j, jmax;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">if</span> ((*<a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>)[rIndex]-&gt;getFunctionParameters()[i]-&gt;getUsage() == <a class="code" href="../../d2/d4b/classCFunctionParameter.html#ab0b7b0afa5fb363d6000f102b8590a1babe45d3446d5eecf154656899eb0e8de1">CFunctionParameter::PARAMETER</a>)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="comment">//metablist = (*mpReactions)[rIndex]-&gt;getParameterMappingMetab(i);</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keyword">const</span> std::vector &lt;std::string&gt; &amp; metabKeylist =</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        (*mpReactions)[rIndex]-&gt;getParameterMappings()[i];</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      jmax = metabKeylist.size();</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; jmax; ++j)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          retset-&gt;insert(metabKeylist[j]);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">return</span> retset;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment"> *   Gets the set of metabolites which change number when a given</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment"> *   reaction is executed.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment"> *   @param rIndex The index of the reaction being executed.</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment"> *   @return The set of affected metabolites.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#ad2031dcea4dcecae4ab4c8f26aa9857f"> 1331</a></span>&#160;std::set&lt;std::string&gt; *<a class="code" href="../../d5/da3/classCHybridMethod.html#ad2031dcea4dcecae4ab4c8f26aa9857f">CHybridMethod::getAffects</a>(<span class="keywordtype">size_t</span> rIndex)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;{</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  std::set&lt;std::string&gt; *retset = <span class="keyword">new</span> std::set&lt;std::string&gt;;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">// Get the balances  associated with the reaction at this index</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// XXX We first get the chemical equation, then the balances, since the getBalances method in CReaction is unimplemented!</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex].size(); i++)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex][i].mMultiplicity != 0)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          retset-&gt;insert(<a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[rIndex][i].mpMetabolite-&gt;getKey());</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">return</span> retset;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment"> *   Gets the set of metabolites, which participate in the given</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment"> *   reaction either as substrate, product or modifier.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment"> *   @param rIndex The index of the reaction being executed.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment"> *   @return The set of participating metabolites.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#af96f8154e8ea63a72705b9ba812c49b9"> 1357</a></span>&#160;std::set&lt;size_t&gt; *<a class="code" href="../../d5/da3/classCHybridMethod.html#af96f8154e8ea63a72705b9ba812c49b9">CHybridMethod::getParticipatesIn</a>(<span class="keywordtype">size_t</span> <span class="comment">/* rIndex */</span>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;{</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  std::set&lt;size_t&gt; *retset = <span class="keyword">new</span> std::set&lt;size_t&gt;;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">return</span> retset;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;}</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment"> *   Prints out data on standard output. Deprecated.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a512038e2463a87b0cda4889951b6bfaf"> 1366</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a512038e2463a87b0cda4889951b6bfaf">CHybridMethod::outputData</a>(std::ostream &amp; os, <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> mode)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a> counter = 0;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">switch</span> (mode)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#aa5b4c690636f6590b09f9894af6293db">mOutputCounter</a> == (counter++))</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;          {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            counter = 0;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            os &lt;&lt; <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;              {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                os &lt;&lt; (*mpMetabolites)[i]-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;              }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        os &lt;&lt; <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            os &lt;&lt; (*mpMetabolites)[i]-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        ;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;}</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment"> *   Prints out various data on standard output for debugging purposes.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#abbb41550d5b97003fd74c08ca1e8f5cd"> 1411</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#abbb41550d5b97003fd74c08ca1e8f5cd">CHybridMethod::outputDebug</a>(std::ostream &amp; os, <span class="keywordtype">size_t</span> level)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;{</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <span class="keywordtype">size_t</span> i, j;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  std::set &lt;size_t&gt;::iterator iter, iterEnd;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;outputDebug(&quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;) *********************************************** BEGIN&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">switch</span> (level)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordflow">case</span> 0:                              <span class="comment">// Everything !!!</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; Name: &quot;</span> &lt;&lt; <a class="code" href="../../d4/da8/classCCopasiObject.html#a879d6756b51f6b58d307940e1343bd10">CCopasiParameter::getObjectName</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;current time: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mNumVariableMetabs: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMaxSteps: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">mMaxSteps</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMaxBalance: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ae670bae6641b50da8038105c44b5f225">mMaxBalance</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMaxIntBeforeStep: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a203f66c74160cf0c70da56c6773979fc">mMaxIntBeforeStep</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mpReactions.size(): &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          os &lt;&lt; *(*<a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>)[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mpMetabolites.size(): &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;          os &lt;&lt; *(*<a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>)[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mStoi: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a>.<a class="code" href="../../d7/dd7/classCMatrix.html#a89c31fa3d2bc0945143171ca39756c74">numRows</a>(); i++)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;          {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a>.<a class="code" href="../../d7/dd7/classCMatrix.html#a8cb7b9f0fac3fc922713fe23777e6c3a">numCols</a>(); j++)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;              os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">mStoi</a>[i][j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;temp: &quot;</span>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;curentState: &quot;</span>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k1: &quot;</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k2: &quot;</span>;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k3: &quot;</span>;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k4: &quot;</span>;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mReactionFlags: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mFirstReactionFlag: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a> == NULL) os &lt;&lt; <span class="stringliteral">&quot;NULL&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">else</span> os &lt;&lt; *<a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMetabFlags: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>.size(); i++)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] == <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;              os &lt;&lt; <span class="stringliteral">&quot;LOW &quot;</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;              os &lt;&lt; <span class="stringliteral">&quot;HIGH &quot;</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;          }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mLocalBalances: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;          {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i].size(); j++)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;              os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>[i][j];</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mLocalSubstrates: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>.size(); i++)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;          {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>[i].size(); j++)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;              os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">mLocalSubstrates</a>[i][j];</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mLowerStochLimit: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mUpperStochLimit: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">//deprecated:      os &lt;&lt; &quot;mOutputCounter: &quot; &lt;&lt; mOutputCounter &lt;&lt; endl;</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mPartitioningInterval: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a714f98c445d63eb279481e1f010b59bd">mPartitioningInterval</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mStepsAfterPartitionSystem: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#aa2568cf74b74743d5c93f5b417adbf0c">mStepsAfterPartitionSystem</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mStepsize: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">mStepsize</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMetab2React: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>.size(); i++)</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            os &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">mMetab2React</a>[i].end(); iter != iterEnd; ++iter)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;              os &lt;&lt; *iter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mAmu: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mAmuOld: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mUpdateSet: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.end(); iter != iterEnd; iter++)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;          os &lt;&lt; *iter;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mpRandomGenerator: &quot;</span> &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">mpRandomGenerator</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mDG: &quot;</span> &lt;&lt; std::endl &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">mDG</a>;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mPQ: &quot;</span> &lt;&lt; std::endl &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;Particle numbers: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            os &lt;&lt; (*mpMetabolites)[i]-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;          }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="keywordflow">case</span> 1:                               <span class="comment">// Variable values only</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;current time: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">mpCurrentState</a>-&gt;<a class="code" href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">getTime</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">        case 1:</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">        os &lt;&lt; &quot;mTime: &quot; &lt;&lt; mpCurrentState-&gt;getTime() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">        os &lt;&lt; &quot;oldState: &quot;;</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">        for (i = 0; i &lt; mDim; i++)</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">          os &lt;&lt; oldState[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">        os &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">        os &lt;&lt; &quot;x: &quot;;</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">        for (i = 0; i &lt; mDim; i++)</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">          os &lt;&lt; x[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">        os &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">        os &lt;&lt; &quot;y: &quot;;</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">        for (i = 0; i &lt; mDim; i++)</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">          os &lt;&lt; y[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">        os &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">        os &lt;&lt; &quot;increment: &quot;;</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">        for (i = 0; i &lt; mDim; i++)</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">          os &lt;&lt; increment[i] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">        os &lt;&lt; std::endl;*/</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;temp: &quot;</span>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">temp</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;currentState: &quot;</span>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">currentState</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k1: &quot;</span>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">k1</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k2: &quot;</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">k2</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k3: &quot;</span>;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">k3</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;k4: &quot;</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">mNumVariableMetabs</a>; i++)</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">k4</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mReactionFlags: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">mLocalBalances</a>.size(); i++)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">mReactionFlags</a>[i];</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mFirstReactionFlag: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">if</span> (mFirstReactionFlag == NULL) os &lt;&lt; <span class="stringliteral">&quot;NULL&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">else</span> os &lt;&lt; *<a class="code" href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">mFirstReactionFlag</a>;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mMetabFlags: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>.size(); i++)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">mMetabFlags</a>[i] == <a class="code" href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">LOW</a>)</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;              os &lt;&lt; <span class="stringliteral">&quot;LOW &quot;</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;              os &lt;&lt; <span class="stringliteral">&quot;HIGH &quot;</span>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mAmu: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">mAmu</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mAmuOld: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">mpReactions</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          os &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">mAmuOld</a>[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mUpdateSet: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.begin(), iterEnd = <a class="code" href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">mUpdateSet</a>.end(); iter != iterEnd; iter++)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;          os &lt;&lt; *iter;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;mPQ: &quot;</span> &lt;&lt; std::endl &lt;&lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">mPQ</a>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;Particle numbers: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">mpMetabolites</a>-&gt;<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>(); i++)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            os &lt;&lt; (*mpMetabolites)[i]-&gt;getValue() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;          }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        os &lt;&lt; std::endl;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        ;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;outputDebug(&quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;) ************************************************* END&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;}</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"><a class="line" href="../../d3/d2d/CHybridMethod_8cpp.html#ac9227c6b861ffd824dc85135587736ed"> 1687</a></span>&#160;std::ostream &amp; <a class="code" href="../../d3/d2d/CHybridMethod_8cpp.html#ac9227c6b861ffd824dc85135587736ed">operator&lt;&lt;</a>(std::ostream &amp; os, <span class="keyword">const</span> <a class="code" href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a> &amp; d)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;{</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;CHybridStochFlag &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;  mIndex: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a> &lt;&lt; <span class="stringliteral">&quot; mValue: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a65e9d5afd2d23d1668e65aad5de76f88">mValue</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="keywordflow">if</span> (d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a> != NULL)</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;  prevIndex: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a>-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a> &lt;&lt; <span class="stringliteral">&quot; prevPointer: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">mpPrev</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;  prevPointer: NULL&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">if</span> (d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a> != NULL)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;  nextIndex: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a>-&gt;<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">mIndex</a> &lt;&lt; <span class="stringliteral">&quot; nextPointer: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">mpNext</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;  nextPointer: NULL&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;}</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"><a class="line" href="../../d3/d2d/CHybridMethod_8cpp.html#a0cef005909523312b09df5941b9bd1b0"> 1705</a></span>&#160;std::ostream &amp; <a class="code" href="../../d3/d2d/CHybridMethod_8cpp.html#ac9227c6b861ffd824dc85135587736ed">operator&lt;&lt;</a>(std::ostream &amp; os, <span class="keyword">const</span> <a class="code" href="../../d0/df3/classCHybridBalance.html">CHybridBalance</a> &amp; d)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;{</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;CHybridBalance&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;  mIndex: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/df3/classCHybridBalance.html#a5ec7ce44f5035e78eeb1aee43b620f4d">mIndex</a> &lt;&lt; <span class="stringliteral">&quot; mMultiplicity: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">mMultiplicity</a></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; mpMetabolite: &quot;</span> &lt;&lt; d.<a class="code" href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">mpMetabolite</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;}</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">//virtual</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a4930c4d80ce52866a7adae0723cb6560"> 1714</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a4930c4d80ce52866a7adae0723cb6560">CHybridMethod::isValidProblem</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d05/classCCopasiProblem.html">CCopasiProblem</a> * pProblem)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;{</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d0/dc9/classCTrajectoryMethod.html#a12dd2cb9e5c0f3a6ec454c36e1624f00">CTrajectoryMethod::isValidProblem</a>(pProblem)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d9/d61/classCTrajectoryProblem.html">CTrajectoryProblem</a> * pTP = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d9/d61/classCTrajectoryProblem.html">CTrajectoryProblem</a> *<span class="keyword">&gt;</span>(pProblem);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d9/d61/classCTrajectoryProblem.html#ab873abbd45b0bfc73c0741c79e423417">getDuration</a>() &lt; 0.0)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="comment">//back integration not possible</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 9);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a024bf40484ed12f7aac227da16b67ac8">getTotSteps</a>() &lt; 1)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="comment">//at least one reaction necessary</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 17);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="comment">//check for rules</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordtype">size_t</span> i, imax = pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a2ca23ed55dff7e2bf82de254176509fb">getNumModelValues</a>();</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#ab3481ad574a3e1935a7617339970eab2">getModelValues</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3c62c1c3a449e106a5f1eb2f4ff01ec3">CModelEntity::ODE</a>)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          <span class="comment">//ode rule found</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;          <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 18);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="comment">/*      if (pTP-&gt;getModel()-&gt;getModelValues()[i]-&gt;getStatus()==CModelEntity::ASSIGNMENT)</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">              if (pTP-&gt;getModel()-&gt;getModelValues()[i]-&gt;isUsed())</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">                {</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">                  //used assignment found</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">                  CCopasiMessage(CCopasiMessage::EXCEPTION, MCTrajectoryMethod + 19);</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">                  return false;</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">                }*/</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  imax = pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a3436ac6288df38f62cea531c5c7aae69">getNumMetabs</a>();</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">getMetabolites</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3c62c1c3a449e106a5f1eb2f4ff01ec3">CModelEntity::ODE</a>)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;          <span class="comment">//ode rule found</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 20);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">getMetabolites</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb">CModelEntity::ASSIGNMENT</a>)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">getMetabolites</a>()[i]-&gt;isUsed())</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;          {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <span class="comment">//used assignment for species found</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 24);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  imax = pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">getCompartments</a>().<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">getCompartments</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3c62c1c3a449e106a5f1eb2f4ff01ec3">CModelEntity::ODE</a>)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          <span class="comment">//ode rule found</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;          <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 21);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">//TODO: rewrite CModel::suitableForStochasticSimulation() to use</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="comment">//      CCopasiMessage</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  std::string message = pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7071c6d0aa1587c71ddb399733545e07">suitableForStochasticSimulation</a>();</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="keywordflow">if</span> (message != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="comment">//model not suitable, message describes the problem</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, message.c_str());</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="comment">/* Max Internal Steps */</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="keywordflow">if</span> (* <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Max Internal Steps&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a50d26400fb0795a03ef6979f6a61f777">pINT</a> &lt;= 0)</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="comment">//max steps should be at least 1</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 15);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="comment">/* Lower Limit, Upper Limit */</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Lower Limit&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a> = * <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Upper Limit&quot;</span>).<a class="code" href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">pDOUBLE</a>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a> &gt; <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a>)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 4, <a class="code" href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">mLowerStochLimit</a>, <a class="code" href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">mUpperStochLimit</a>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">/* Runge Kutta Stepsize */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">if</span> (* <a class="code" href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">getValue</a>(<span class="stringliteral">&quot;Runge Kutta Stepsize&quot;</span>).pDOUBLE &lt;= 0.0)</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="comment">// Runge Kutta Stepsize must be positive</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 13);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="comment">/* Partitioning Interval */</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="comment">// nothing to be done here so far</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="comment">/* Use Random Seed */</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="comment">// should be checked in the widget later on</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="comment">/* Random Seed */</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">// nothing to be done here</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">//events are not supported at the moment</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="keywordflow">if</span> (pTP-&gt;<a class="code" href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">getModel</a>()-&gt;<a class="code" href="../../d4/d04/classCModel.html#ad55cc48064428d703cee3e69b71e4703">getEvents</a>().<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>() &gt; 0)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <a class="code" href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a>(<a class="code" href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a>, <a class="code" href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a> + 23);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;}</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">//static</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"><a class="line" href="../../d5/da3/classCHybridMethod.html#a74dd307cee2fecfcfc19032be5446521"> 1844</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/da3/classCHybridMethod.html#a74dd307cee2fecfcfc19032be5446521">CHybridMethod::modelHasAssignments</a>(<span class="keyword">const</span> <a class="code" href="../../d4/d04/classCModel.html">CModel</a>* pModel)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;{</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordtype">size_t</span> i, imax = pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a2ca23ed55dff7e2bf82de254176509fb">getNumModelValues</a>();</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#ab3481ad574a3e1935a7617339970eab2">getModelValues</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb">CModelEntity::ASSIGNMENT</a>)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#ab3481ad574a3e1935a7617339970eab2">getModelValues</a>()[i]-&gt;isUsed())</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <span class="comment">//used assignment found</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;          }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  imax = pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a3436ac6288df38f62cea531c5c7aae69">getNumMetabs</a>();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    {</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">getMetabolites</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb">CModelEntity::ASSIGNMENT</a>)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">getMetabolites</a>()[i]-&gt;isUsed())</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;          {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="comment">//used assignment found</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;          }</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  imax = pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">getCompartments</a>().<a class="code" href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">size</a>();</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; imax; ++i)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">getCompartments</a>()[i]-&gt;getStatus() == <a class="code" href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb">CModelEntity::ASSIGNMENT</a>)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">if</span> (pModel-&gt;<a class="code" href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">getCompartments</a>()[i]-&gt;isUsed())</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            <span class="comment">//used assignment found</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;          }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;}</div>
<div class="ttc" id="CVersion_8h_html"><div class="ttname"><a href="../../d1/d4f/CVersion_8h.html">CVersion.h</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_aadd0b9793aacfebce6c6f01fb8d7ef5e"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#aadd0b9793aacfebce6c6f01fb8d7ef5e">CIndexedPriorityQueue::topKey</a></div><div class="ttdeci">C_FLOAT64 topKey() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00033">CIndexedPriorityQueue.cpp:33</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ad85adf4251b97a77c58899a43980ef27"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ad85adf4251b97a77c58899a43980ef27">CHybridMethod::mpRandomGenerator</a></div><div class="ttdeci">CRandom * mpRandomGenerator</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00604">CHybridMethod.h:604</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a8eb82ec01cfc4e05f558af5bd809314c"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a8eb82ec01cfc4e05f558af5bd809314c">CHybridMethod::partitionSystem</a></div><div class="ttdeci">void partitionSystem()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01162">CHybridMethod.cpp:1162</a></div></div>
<div class="ttc" id="classCRandom_html_ae24dac97c3e9ec67a54db42f81b34f56a784a1373c483e406ff533f105c7a7af8"><div class="ttname"><a href="../../df/dcb/classCRandom.html#ae24dac97c3e9ec67a54db42f81b34f56a784a1373c483e406ff533f105c7a7af8">CRandom::mt19937</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d98/CRandom_8h_source.html#l00058">CRandom.h:58</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aeddbc8ed86b091cd40fcddf1c155c63c"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aeddbc8ed86b091cd40fcddf1c155c63c">CHybridMethod::mLowerStochLimit</a></div><div class="ttdeci">C_FLOAT64 mLowerStochLimit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00567">CHybridMethod.h:567</a></div></div>
<div class="ttc" id="CHybridMethod_8cpp_html_ac9227c6b861ffd824dc85135587736ed"><div class="ttname"><a href="../../d3/d2d/CHybridMethod_8cpp.html#ac9227c6b861ffd824dc85135587736ed">operator&lt;&lt;</a></div><div class="ttdeci">std::ostream &amp; operator&lt;&lt;(std::ostream &amp;os, const CHybridStochFlag &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01687">CHybridMethod.cpp:1687</a></div></div>
<div class="ttc" id="classCTrajectoryProblem_html"><div class="ttname"><a href="../../d9/d61/classCTrajectoryProblem.html">CTrajectoryProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/de2/CTrajectoryProblem_8h_source.html#l00031">CTrajectoryProblem.h:31</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a761f05c00d457d67a5c9dba3181c1d93"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a761f05c00d457d67a5c9dba3181c1d93">CHybridMethod::mMaxSteps</a></div><div class="ttdeci">unsigned C_INT32 mMaxSteps</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00482">CHybridMethod.h:482</a></div></div>
<div class="ttc" id="CIndexedPriorityQueue_8h_html"><div class="ttname"><a href="../../db/ddb/CIndexedPriorityQueue_8h.html">CIndexedPriorityQueue.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a7949172e09c0668d4f50b9645acdaf8c"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a7949172e09c0668d4f50b9645acdaf8c">CHybridMethod::mpModel</a></div><div class="ttdeci">CModel * mpModel</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00467">CHybridMethod.h:467</a></div></div>
<div class="ttc" id="classCHybridBalance_html_a5ec7ce44f5035e78eeb1aee43b620f4d"><div class="ttname"><a href="../../d0/df3/classCHybridBalance.html#a5ec7ce44f5035e78eeb1aee43b620f4d">CHybridBalance::mIndex</a></div><div class="ttdeci">size_t mIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00105">CHybridMethod.h:105</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a191785e3885c114a1d6d7c18267b50d4"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a191785e3885c114a1d6d7c18267b50d4">CHybridMethod::mHasAssignments</a></div><div class="ttdeci">bool mHasAssignments</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00642">CHybridMethod.h:642</a></div></div>
<div class="ttc" id="classCModel_html_ad55cc48064428d703cee3e69b71e4703"><div class="ttname"><a href="../../d4/d04/classCModel.html#ad55cc48064428d703cee3e69b71e4703">CModel::getEvents</a></div><div class="ttdeci">CCopasiVectorN&lt; CEvent &gt; &amp; getEvents()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01110">CModel.cpp:1110</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a512038e2463a87b0cda4889951b6bfaf"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a512038e2463a87b0cda4889951b6bfaf">CHybridMethod::outputData</a></div><div class="ttdeci">void outputData(std::ostream &amp;os, C_INT32 mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01366">CHybridMethod.cpp:1366</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aaacb253b96bfd9968c52abd8de086394"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aaacb253b96bfd9968c52abd8de086394">CHybridMethod::getState</a></div><div class="ttdeci">void getState(std::vector&lt; C_FLOAT64 &gt; &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00529">CHybridMethod.cpp:529</a></div></div>
<div class="ttc" id="unionCCopasiParameter_1_1Value_html_a50d26400fb0795a03ef6979f6a61f777"><div class="ttname"><a href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a50d26400fb0795a03ef6979f6a61f777">CCopasiParameter::Value::pINT</a></div><div class="ttdeci">C_INT32 * pINT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00059">CCopasiParameter.h:59</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac3f14c7f4bba32eacb0c4adf2e8c160a"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac3f14c7f4bba32eacb0c4adf2e8c160a">CHybridMethod::getStochTimeAndIndex</a></div><div class="ttdeci">void getStochTimeAndIndex(C_FLOAT64 &amp;ds, size_t &amp;rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00574">CHybridMethod.cpp:574</a></div></div>
<div class="ttc" id="classCModel_html_a73a8a52c2190b1aae2f1427e4e9eb0e1"><div class="ttname"><a href="../../d4/d04/classCModel.html#a73a8a52c2190b1aae2f1427e4e9eb0e1">CModel::getMetabolites</a></div><div class="ttdeci">const CCopasiVector&lt; CMetab &gt; &amp; getMetabolites() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01051">CModel.cpp:1051</a></div></div>
<div class="ttc" id="classCCopasiObject_html_a879d6756b51f6b58d307940e1343bd10"><div class="ttname"><a href="../../d4/da8/classCCopasiObject.html#a879d6756b51f6b58d307940e1343bd10">CCopasiObject::getObjectName</a></div><div class="ttdeci">const std::string &amp; getObjectName() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d22/CCopasiObject_8cpp_source.html#l00258">CCopasiObject.cpp:258</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a203f66c74160cf0c70da56c6773979fc"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a203f66c74160cf0c70da56c6773979fc">CHybridMethod::mMaxIntBeforeStep</a></div><div class="ttdeci">size_t mMaxIntBeforeStep</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00505">CHybridMethod.h:505</a></div></div>
<div class="ttc" id="classCModel_html_ab3481ad574a3e1935a7617339970eab2"><div class="ttname"><a href="../../d4/d04/classCModel.html#ab3481ad574a3e1935a7617339970eab2">CModel::getModelValues</a></div><div class="ttdeci">const CCopasiVectorN&lt; CModelValue &gt; &amp; getModelValues() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01060">CModel.cpp:1060</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a3b97c783a23bdba910a59b475a49111e"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a3b97c783a23bdba910a59b475a49111e">CHybridMethod::setupBalances</a></div><div class="ttdeci">void setupBalances()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00845">CHybridMethod.cpp:845</a></div></div>
<div class="ttc" id="classCRandom_html_a410b37bfff992d5d2b30fd4cb635a0e0"><div class="ttname"><a href="../../df/dcb/classCRandom.html#a410b37bfff992d5d2b30fd4cb635a0e0">CRandom::getRandomOO</a></div><div class="ttdeci">virtual C_FLOAT64 getRandomOO()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df8/CRandom_8cpp_source.html#l00254">CRandom.cpp:254</a></div></div>
<div class="ttc" id="classCCopasiVector_html_ab7e0e37022783eddfe85abf9339b05c0"><div class="ttname"><a href="../../d8/d2c/classCCopasiVector.html#ab7e0e37022783eddfe85abf9339b05c0">CCopasiVector::size</a></div><div class="ttdeci">virtual size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d51/CCopasiVector_8h_source.html#l00386">CCopasiVector.h:386</a></div></div>
<div class="ttc" id="classCDependencyGraph_html_abe79ef02c78a79c68b1f691ba4ee5c8c"><div class="ttname"><a href="../../da/da0/classCDependencyGraph.html#abe79ef02c78a79c68b1f691ba4ee5c8c">CDependencyGraph::addDependent</a></div><div class="ttdeci">void addDependent(const size_t &amp;node, const size_t &amp;dependent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9c/CDependencyGraph_8cpp_source.html#l00068">CDependencyGraph.cpp:68</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4cd08c91c12fe261a45100465b521ad0"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4cd08c91c12fe261a45100465b521ad0">CHybridMethod::mMaxStepsReached</a></div><div class="ttdeci">bool mMaxStepsReached</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00484">CHybridMethod.h:484</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aae947d02310b4078666a67ae1b709861"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aae947d02310b4078666a67ae1b709861">CHybridMethod::initMethod</a></div><div class="ttdeci">void initMethod(C_FLOAT64 time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00264">CHybridMethod.cpp:264</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aba3cf747058e8e557e4736177c539027"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aba3cf747058e8e557e4736177c539027">CHybridMethod::calculateDerivative</a></div><div class="ttdeci">void calculateDerivative(std::vector&lt; C_FLOAT64 &gt; &amp;deriv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00489">CHybridMethod.cpp:489</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aaf7114f8bd3fb9314ddd9244197fada0"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aaf7114f8bd3fb9314ddd9244197fada0">CHybridMethod::checkModel</a></div><div class="ttdeci">static C_INT32 checkModel(CModel *model)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00804">CHybridMethod.cpp:804</a></div></div>
<div class="ttc" id="classCModel_html_a3436ac6288df38f62cea531c5c7aae69"><div class="ttname"><a href="../../d4/d04/classCModel.html#a3436ac6288df38f62cea531c5c7aae69">CModel::getNumMetabs</a></div><div class="ttdeci">size_t getNumMetabs() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01118">CModel.cpp:1118</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ab85fd6653299a8dffe24ce01f9d90dd5"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ab85fd6653299a8dffe24ce01f9d90dd5">CHybridMethod::k3</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; k3</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00534">CHybridMethod.h:534</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a678220807fd33351be94d368b29ce4c9"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a678220807fd33351be94d368b29ce4c9">CHybridMethod::mMetabFlags</a></div><div class="ttdeci">std::vector&lt; metabStatus &gt; mMetabFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00549">CHybridMethod.h:549</a></div></div>
<div class="ttc" id="CRandom_8h_html"><div class="ttname"><a href="../../d9/d98/CRandom_8h.html">CRandom.h</a></div></div>
<div class="ttc" id="CMatrix_8h_html"><div class="ttname"><a href="../../de/dbd/CMatrix_8h.html">CMatrix.h</a></div></div>
<div class="ttc" id="classCModel_html_a7c6e6e91ffe791d367e0a32ba5602014"><div class="ttname"><a href="../../d4/d04/classCModel.html#a7c6e6e91ffe791d367e0a32ba5602014">CModel::updateSimulatedValues</a></div><div class="ttdeci">void updateSimulatedValues(const bool &amp;updateMoieties)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01851">CModel.cpp:1851</a></div></div>
<div class="ttc" id="classCMatrix_html_a89c31fa3d2bc0945143171ca39756c74"><div class="ttname"><a href="../../d7/dd7/classCMatrix.html#a89c31fa3d2bc0945143171ca39756c74">CMatrix::numRows</a></div><div class="ttdeci">virtual size_t numRows() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dbd/CMatrix_8h_source.html#l00138">CMatrix.h:138</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_afcabafc49128a4367fc72a9984da15cb"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#afcabafc49128a4367fc72a9984da15cb">USE_RANDOM_SEED</a></div><div class="ttdeci">#define USE_RANDOM_SEED</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00067">CHybridMethod.h:67</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_a926b4fb85bd966e882755639126fe811"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#a926b4fb85bd966e882755639126fe811">UPPER_STOCH_LIMIT</a></div><div class="ttdeci">#define UPPER_STOCH_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00061">CHybridMethod.h:61</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac7a7515941f4e6c9d97f60b87c6260fc"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac7a7515941f4e6c9d97f60b87c6260fc">CHybridMethod::mFirstReactionFlag</a></div><div class="ttdeci">CHybridStochFlag * mFirstReactionFlag</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00543">CHybridMethod.h:543</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4ea17684648872d7713442d0dce7d4d4"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4ea17684648872d7713442d0dce7d4d4">CHybridMethod::setState</a></div><div class="ttdeci">void setState(std::vector&lt; C_FLOAT64 &gt; &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00549">CHybridMethod.cpp:549</a></div></div>
<div class="ttc" id="classCHybridBalance_html"><div class="ttname"><a href="../../d0/df3/classCHybridBalance.html">CHybridBalance</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00102">CHybridMethod.h:102</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_aba6eb8a6ee596d44eea3e071940e7863"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#aba6eb8a6ee596d44eea3e071940e7863">INT_EPSILON</a></div><div class="ttdeci">#define INT_EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00059">CHybridMethod.h:59</a></div></div>
<div class="ttc" id="classCState_html"><div class="ttname"><a href="../../dc/d1d/classCState.html">CState</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/CState_8h_source.html#l00305">CState.h:305</a></div></div>
<div class="ttc" id="classCDependencyGraph_html_a8f084d356c98ede0514d96cf91239f9f"><div class="ttname"><a href="../../da/da0/classCDependencyGraph.html#a8f084d356c98ede0514d96cf91239f9f">CDependencyGraph::getDependents</a></div><div class="ttdeci">const std::set&lt; size_t &gt; &amp; getDependents(const size_t &amp;node) const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9c/CDependencyGraph_8cpp_source.html#l00074">CDependencyGraph.cpp:74</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html_a8bdcb597add1e9e8ce0e9e63961919a2"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html#a8bdcb597add1e9e8ce0e9e63961919a2">CTrajectoryMethod::mpProblem</a></div><div class="ttdeci">CTrajectoryProblem * mpProblem</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7d/CTrajectoryMethod_8h_source.html#l00068">CTrajectoryMethod.h:68</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ae670bae6641b50da8038105c44b5f225"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ae670bae6641b50da8038105c44b5f225">CHybridMethod::mMaxBalance</a></div><div class="ttdeci">size_t mMaxBalance</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00500">CHybridMethod.h:500</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_a2fad04e91f10c55c7e0c006e32be2571"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#a2fad04e91f10c55c7e0c006e32be2571">PARTITIONING_INTERVAL</a></div><div class="ttdeci">#define PARTITIONING_INTERVAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00063">CHybridMethod.h:63</a></div></div>
<div class="ttc" id="classCHybridMethod_html_af96f8154e8ea63a72705b9ba812c49b9"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#af96f8154e8ea63a72705b9ba812c49b9">CHybridMethod::getParticipatesIn</a></div><div class="ttdeci">std::set&lt; size_t &gt; * getParticipatesIn(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01357">CHybridMethod.cpp:1357</a></div></div>
<div class="ttc" id="classCModelEntity_html_a46635849ce0741538dc390f682571738"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#a46635849ce0741538dc390f682571738">CModelEntity::setValue</a></div><div class="ttdeci">virtual void setValue(const C_FLOAT64 &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da3/CModelValue_8cpp_source.html#l00378">CModelValue.cpp:378</a></div></div>
<div class="ttc" id="classCCopasiMessage_html_a2ea1ed32494ff5c8d84353efcec7a5e4ac789e90eead3612a24114b9eae58fdec"><div class="ttname"><a href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4ac789e90eead3612a24114b9eae58fdec">CCopasiMessage::WARNING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/CCopasiMessage_8h_source.html#l00086">CCopasiMessage.h:86</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_a990edf51308a42b583fde55e2b9bedb7"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#a990edf51308a42b583fde55e2b9bedb7">RANDOM_SEED</a></div><div class="ttdeci">#define RANDOM_SEED</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00068">CHybridMethod.h:68</a></div></div>
<div class="ttc" id="copasi_8h_html_aa623c2be2264b57fb3953a22ac74a470"><div class="ttname"><a href="../../dc/df8/copasi_8h.html#aa623c2be2264b57fb3953a22ac74a470">C_INVALID_INDEX</a></div><div class="ttdeci">#define C_INVALID_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/copasi_8h_source.html#l00222">copasi.h:222</a></div></div>
<div class="ttc" id="classCMatrix_html"><div class="ttname"><a href="../../d7/dd7/classCMatrix.html">CMatrix&lt; C_FLOAT64 &gt;</a></div></div>
<div class="ttc" id="classCStateTemplate_html_a560610b4966dbc401d69f9f32a2c3bdb"><div class="ttname"><a href="../../d7/dc0/classCStateTemplate.html#a560610b4966dbc401d69f9f32a2c3bdb">CStateTemplate::getIndex</a></div><div class="ttdeci">size_t getIndex(const CModelEntity *entity) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5a/CState_8cpp_source.html#l00231">CState.cpp:231</a></div></div>
<div class="ttc" id="copasi_8h_html_ab51793927eb923d40cd2161bbbe98b7d"><div class="ttname"><a href="../../dc/df8/copasi_8h.html#ab51793927eb923d40cd2161bbbe98b7d">C_INT64</a></div><div class="ttdeci">#define C_INT64</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/copasi_8h_source.html#l00088">copasi.h:88</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5ffffbe81b45fa2031bde3dcb7ec0bf8"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5ffffbe81b45fa2031bde3dcb7ec0bf8">CHybridMethod::setupMetab2ReactComplete</a></div><div class="ttdeci">void setupMetab2ReactComplete()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01030">CHybridMethod.cpp:1030</a></div></div>
<div class="ttc" id="classCCopasiParameter_html"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html">CCopasiParameter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00035">CCopasiParameter.h:35</a></div></div>
<div class="ttc" id="CCopasiVector_8h_html"><div class="ttname"><a href="../../d7/d51/CCopasiVector_8h.html">CCopasiVector.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_afb711cc983c5b19d0c40222d93eda812"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#afb711cc983c5b19d0c40222d93eda812">CHybridMethod::mStoi</a></div><div class="ttdeci">CMatrix&lt; C_FLOAT64 &gt; mStoi</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00525">CHybridMethod.h:525</a></div></div>
<div class="ttc" id="copasi_8h_html_a9e77742fb2ec39ea4ec3f3fbe6758c2d"><div class="ttname"><a href="../../dc/df8/copasi_8h.html#a9e77742fb2ec39ea4ec3f3fbe6758c2d">C_INT32</a></div><div class="ttdeci">#define C_INT32</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/copasi_8h_source.html#l00090">copasi.h:90</a></div></div>
<div class="ttc" id="classCCopasiMethod_html"><div class="ttname"><a href="../../df/d49/classCCopasiMethod.html">CCopasiMethod</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d39/CCopasiMethod_8h_source.html#l00034">CCopasiMethod.h:34</a></div></div>
<div class="ttc" id="classCDependencyGraph_html_a4e48c4064d234e1aa75d795849e7c250"><div class="ttname"><a href="../../da/da0/classCDependencyGraph.html#a4e48c4064d234e1aa75d795849e7c250">CDependencyGraph::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9c/CDependencyGraph_8cpp_source.html#l00086">CDependencyGraph.cpp:86</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_a122816d215f833f8b004cc48c240a398"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#a122816d215f833f8b004cc48c240a398">CIndexedPriorityQueue::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00135">CIndexedPriorityQueue.cpp:135</a></div></div>
<div class="ttc" id="classCHybridMethod_html_af06d3b400d020a2a5a32ef17d6c0e6af"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#af06d3b400d020a2a5a32ef17d6c0e6af">CHybridMethod::mPQ</a></div><div class="ttdeci">CIndexedPriorityQueue mPQ</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00619">CHybridMethod.h:619</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_acc438462395ab9af5cb4bdb2340d44a5"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#acc438462395ab9af5cb4bdb2340d44a5">CIndexedPriorityQueue::getKey</a></div><div class="ttdeci">C_FLOAT64 getKey(const size_t index) const </div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddb/CIndexedPriorityQueue_8h_source.html#l00172">CIndexedPriorityQueue.h:172</a></div></div>
<div class="ttc" id="classCModelEntity_html_a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3bfd50e7d8e4dd09716a51e0ca62dedb">CModelEntity::ASSIGNMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da3/CModelValue_8h_source.html#l00056">CModelValue.h:56</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a0939454d0b62bd29c0414ded979f4341"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a0939454d0b62bd29c0414ded979f4341">CHybridMethod::setupMetab2ReactPlusModifier</a></div><div class="ttdeci">void setupMetab2ReactPlusModifier()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00993">CHybridMethod.cpp:993</a></div></div>
<div class="ttc" id="classCMetab_html"><div class="ttname"><a href="../../dc/d44/classCMetab.html">CMetab</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df5/CMetab_8h_source.html#l00178">CMetab.h:178</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html_a12dd2cb9e5c0f3a6ec454c36e1624f00"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html#a12dd2cb9e5c0f3a6ec454c36e1624f00">CTrajectoryMethod::isValidProblem</a></div><div class="ttdeci">virtual bool isValidProblem(const CCopasiProblem *pProblem)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7b/CTrajectoryMethod_8cpp_source.html#l00165">CTrajectoryMethod.cpp:165</a></div></div>
<div class="ttc" id="CModel_8h_html"><div class="ttname"><a href="../../d6/d90/CModel_8h.html">CModel.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ab31ca49dcc0b115f669dc28811d34a91"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ab31ca49dcc0b115f669dc28811d34a91">CHybridMethod::step</a></div><div class="ttdeci">virtual Status step(const double &amp;deltaT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00184">CHybridMethod.cpp:184</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4c23a4b88ac80dd5070c55028fdafe7f"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4c23a4b88ac80dd5070c55028fdafe7f">CHybridMethod::mFirstMetabIndex</a></div><div class="ttdeci">size_t mFirstMetabIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00477">CHybridMethod.h:477</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fa45b8160b0b846997f75a82af4ca352ba">CHybridMethod::LOW</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00462">CHybridMethod.h:462</a></div></div>
<div class="ttc" id="classCState_html_acc695ac82480dc0674b2df5fd9bc18e5"><div class="ttname"><a href="../../dc/d1d/classCState.html#acc695ac82480dc0674b2df5fd9bc18e5">CState::setTime</a></div><div class="ttdeci">void setTime(const C_FLOAT64 &amp;time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5a/CState_8cpp_source.html#l00326">CState.cpp:326</a></div></div>
<div class="ttc" id="classCHybridStochFlag_html_a0587b140f79ebdadbd87a602ba380071"><div class="ttname"><a href="../../d0/d6c/classCHybridStochFlag.html#a0587b140f79ebdadbd87a602ba380071">CHybridStochFlag::mpPrev</a></div><div class="ttdeci">CHybridStochFlag * mpPrev</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00091">CHybridMethod.h:91</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_aa0414caef00a64a51d4c6c0711d9e70a"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#aa0414caef00a64a51d4c6c0711d9e70a">MAX_STEPS</a></div><div class="ttdeci">#define MAX_STEPS</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00058">CHybridMethod.h:58</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ae951ba87bd7993bdc120b4950d91e19b"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ae951ba87bd7993bdc120b4950d91e19b">CHybridMethod::initializeParameter</a></div><div class="ttdeci">void initializeParameter()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00087">CHybridMethod.cpp:87</a></div></div>
<div class="ttc" id="classCModel_html_a024bf40484ed12f7aac227da16b67ac8"><div class="ttname"><a href="../../d4/d04/classCModel.html#a024bf40484ed12f7aac227da16b67ac8">CModel::getTotSteps</a></div><div class="ttdeci">size_t getTotSteps() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01136">CModel.cpp:1136</a></div></div>
<div class="ttc" id="classCCopasiVectorNS_html"><div class="ttname"><a href="../../d9/db9/classCCopasiVectorNS.html">CCopasiVectorNS&lt; CReaction &gt;</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4750addb2803c82833260aa406148950"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4750addb2803c82833260aa406148950">CHybridMethod::updateTauMu</a></div><div class="ttdeci">void updateTauMu(size_t rIndex, C_FLOAT64 time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00772">CHybridMethod.cpp:772</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ad6d222058285ccaef769ec39d0973c5d"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ad6d222058285ccaef769ec39d0973c5d">CHybridMethod::integrateDeterministicPart</a></div><div class="ttdeci">void integrateDeterministicPart(C_FLOAT64 ds)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00335">CHybridMethod.cpp:335</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ab2c68ba9951c4ee5e6b33599a20b2404"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ab2c68ba9951c4ee5e6b33599a20b2404">CHybridMethod::removeDeterministicReaction</a></div><div class="ttdeci">void removeDeterministicReaction(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01259">CHybridMethod.cpp:1259</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ae9b58bea04f43b2b2cac1ca5b039beed"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ae9b58bea04f43b2b2cac1ca5b039beed">CHybridMethod::rungeKutta</a></div><div class="ttdeci">void rungeKutta(C_FLOAT64 dt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00412">CHybridMethod.cpp:412</a></div></div>
<div class="ttc" id="classCCopasiProblem_html"><div class="ttname"><a href="../../d1/d05/classCCopasiProblem.html">CCopasiProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d1d/CCopasiProblem_8h_source.html#l00040">CCopasiProblem.h:40</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_a18357c86629fe757e3120258ce81ef56acccd91675f2cfef22208d6c1efeba228"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56acccd91675f2cfef22208d6c1efeba228">CCopasiParameter::BOOL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00045">CCopasiParameter.h:45</a></div></div>
<div class="ttc" id="classCCopasiParameterGroup_html_adb15626310efb87eb4b79fbb93098bc9"><div class="ttname"><a href="../../df/d89/classCCopasiParameterGroup.html#adb15626310efb87eb4b79fbb93098bc9">CCopasiParameterGroup::removeParameter</a></div><div class="ttdeci">bool removeParameter(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d56/CCopasiParameterGroup_8cpp_source.html#l00309">CCopasiParameterGroup.cpp:309</a></div></div>
<div class="ttc" id="classCHybridMethod_html_af2d0c8890f222e2985fd06f0f1c3f243"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#af2d0c8890f222e2985fd06f0f1c3f243">CHybridMethod::mpReactions</a></div><div class="ttdeci">const CCopasiVectorNS&lt; CReaction &gt; * mpReactions</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00515">CHybridMethod.h:515</a></div></div>
<div class="ttc" id="CCopasiMessage_8h_html_a273cca8b4347bd9c4f8f3ac768f86e83"><div class="ttname"><a href="../../d9/d2d/CCopasiMessage_8h.html#a273cca8b4347bd9c4f8f3ac768f86e83">MCTrajectoryMethod</a></div><div class="ttdeci">#define MCTrajectoryMethod</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/CCopasiMessage_8h_source.html#l00041">CCopasiMessage.h:41</a></div></div>
<div class="ttc" id="copasi_8h_html_afb56de89ba93afccedfe4db80fb5aa2e"><div class="ttname"><a href="../../dc/df8/copasi_8h.html#afb56de89ba93afccedfe4db80fb5aa2e">DESTRUCTOR_TRACE</a></div><div class="ttdeci">#define DESTRUCTOR_TRACE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/copasi_8h_source.html#l00206">copasi.h:206</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a1e00c230ed1bb79b2e1fd6f1e11932c4"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a1e00c230ed1bb79b2e1fd6f1e11932c4">CHybridMethod::k4</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; k4</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00535">CHybridMethod.h:535</a></div></div>
<div class="ttc" id="classCHybridStochFlag_html_add88cbcf4dacea9a0367fa7ab4251bf4"><div class="ttname"><a href="../../d0/d6c/classCHybridStochFlag.html#add88cbcf4dacea9a0367fa7ab4251bf4">CHybridStochFlag::mIndex</a></div><div class="ttdeci">size_t mIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00089">CHybridMethod.h:89</a></div></div>
<div class="ttc" id="classCRandom_html_af284fc89ba1c3e15f2463b12be647320"><div class="ttname"><a href="../../df/dcb/classCRandom.html#af284fc89ba1c3e15f2463b12be647320">CRandom::createGenerator</a></div><div class="ttdeci">static CRandom * createGenerator(CRandom::Type type=CRandom::mt19937, unsigned C_INT32 seed=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df8/CRandom_8cpp_source.html#l00049">CRandom.cpp:49</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a62b0ac745bc9bf066a1cd484029939cf"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a62b0ac745bc9bf066a1cd484029939cf">CHybridMethod::doSingleStep</a></div><div class="ttdeci">virtual C_FLOAT64 doSingleStep(C_FLOAT64 currentTime, C_FLOAT64 endTime)=0</div></div>
<div class="ttc" id="classCModel_html_ab917cbb21d517aaa490416066d57ebb0"><div class="ttname"><a href="../../d4/d04/classCModel.html#ab917cbb21d517aaa490416066d57ebb0">CModel::getNumVariableMetabs</a></div><div class="ttdeci">size_t getNumVariableMetabs() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01121">CModel.cpp:1121</a></div></div>
<div class="ttc" id="classCModel_html_afd44438ad6fc4bdd5f2ef6a7fc7993bb"><div class="ttname"><a href="../../d4/d04/classCModel.html#afd44438ad6fc4bdd5f2ef6a7fc7993bb">CModel::getNumDependentReactionMetabs</a></div><div class="ttdeci">size_t getNumDependentReactionMetabs() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01133">CModel.cpp:1133</a></div></div>
<div class="ttc" id="classCHybridMethod_html_abbb41550d5b97003fd74c08ca1e8f5cd"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#abbb41550d5b97003fd74c08ca1e8f5cd">CHybridMethod::outputDebug</a></div><div class="ttdeci">void outputDebug(std::ostream &amp;os, size_t level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01411">CHybridMethod.cpp:1411</a></div></div>
<div class="ttc" id="classCModel_html_a4f2900711f3da1980a14ac2617581820"><div class="ttname"><a href="../../d4/d04/classCModel.html#a4f2900711f3da1980a14ac2617581820">CModel::setState</a></div><div class="ttdeci">void setState(const CState &amp;state)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01785">CModel.cpp:1785</a></div></div>
<div class="ttc" id="classCModel_html_a607d468405aace77f2181ef72c73435ca852877a1fa93e102c671cc015189d7bb"><div class="ttname"><a href="../../d4/d04/classCModel.html#a607d468405aace77f2181ef72c73435ca852877a1fa93e102c671cc015189d7bb">CModel::deterministic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/CModel_8h_source.html#l00112">CModel.h:112</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html">CHybridMethod.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_afbaf36bd9870d7db0d13b76c4478e471"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#afbaf36bd9870d7db0d13b76c4478e471">CHybridMethod::~CHybridMethod</a></div><div class="ttdeci">~CHybridMethod()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00081">CHybridMethod.cpp:81</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_a8bbac1ce28fa03f30ccd84e281534e18"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#a8bbac1ce28fa03f30ccd84e281534e18">CIndexedPriorityQueue::insertStochReaction</a></div><div class="ttdeci">size_t insertStochReaction(const size_t index, const C_FLOAT64 key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00068">CIndexedPriorityQueue.cpp:68</a></div></div>
<div class="ttc" id="classCTrajectoryProblem_html_ab873abbd45b0bfc73c0741c79e423417"><div class="ttname"><a href="../../d9/d61/classCTrajectoryProblem.html#ab873abbd45b0bfc73c0741c79e423417">CTrajectoryProblem::getDuration</a></div><div class="ttdeci">const C_FLOAT64 &amp; getDuration() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d44/CTrajectoryProblem_8cpp_source.html#l00178">CTrajectoryProblem.cpp:178</a></div></div>
<div class="ttc" id="copasi_8h_html"><div class="ttname"><a href="../../dc/df8/copasi_8h.html">copasi.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a58a0c7a8c60140d117b8f63f6c6129c5"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a58a0c7a8c60140d117b8f63f6c6129c5">CHybridMethod::mDG</a></div><div class="ttdeci">CDependencyGraph mDG</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00610">CHybridMethod.h:610</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ad02c41eaa01fddb8d0bfb6a85202c019"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ad02c41eaa01fddb8d0bfb6a85202c019">CHybridMethod::CHybridMethod</a></div><div class="ttdeci">CHybridMethod(const CHybridMethod &amp;src, const CCopasiContainer *pParent=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00070">CHybridMethod.cpp:70</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_a35b854e4de8462680ae5fd092ef18098"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#a35b854e4de8462680ae5fd092ef18098">CCopasiParameter::getValue</a></div><div class="ttdeci">const Value &amp; getValue() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d99/CCopasiParameter_8cpp_source.html#l00247">CCopasiParameter.cpp:247</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a6a917962fc9d55685e4c62ec541de4ec"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a6a917962fc9d55685e4c62ec541de4ec">CHybridMethod::elevateChildren</a></div><div class="ttdeci">virtual bool elevateChildren()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00143">CHybridMethod.cpp:143</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ab036b414661fb6fbb3435dec7899194a"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ab036b414661fb6fbb3435dec7899194a">CHybridMethod::generateReactionTime</a></div><div class="ttdeci">C_FLOAT64 generateReactionTime(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00678">CHybridMethod.cpp:678</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a539f9b2f02b1db99e4533354d9228647"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a539f9b2f02b1db99e4533354d9228647">CHybridMethod::mUseRandomSeed</a></div><div class="ttdeci">bool mUseRandomSeed</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00490">CHybridMethod.h:490</a></div></div>
<div class="ttc" id="classCCopasiParameterGroup_html_ab91e4797ef98e75ca8ab665a0db95c02"><div class="ttname"><a href="../../df/d89/classCCopasiParameterGroup.html#ab91e4797ef98e75ca8ab665a0db95c02">CCopasiParameterGroup::setValue</a></div><div class="ttdeci">bool setValue(const std::string &amp;name, const CType &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d95/CCopasiParameterGroup_8h_source.html#l00361">CCopasiParameterGroup.h:361</a></div></div>
<div class="ttc" id="classCHybridStochFlag_html_a65e9d5afd2d23d1668e65aad5de76f88"><div class="ttname"><a href="../../d0/d6c/classCHybridStochFlag.html#a65e9d5afd2d23d1668e65aad5de76f88">CHybridStochFlag::mValue</a></div><div class="ttdeci">size_t mValue</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00090">CHybridMethod.h:90</a></div></div>
<div class="ttc" id="unionCCopasiParameter_1_1Value_html_aff3513fc28ecdd68e86a60f5df54816b"><div class="ttname"><a href="../../d8/dea/unionCCopasiParameter_1_1Value.html#aff3513fc28ecdd68e86a60f5df54816b">CCopasiParameter::Value::pUINT</a></div><div class="ttdeci">unsigned C_INT32 * pUINT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00060">CCopasiParameter.h:60</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_ac2eff921e71ef8fe991002bde5fe1d6e"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#ac2eff921e71ef8fe991002bde5fe1d6e">CIndexedPriorityQueue::topIndex</a></div><div class="ttdeci">size_t topIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00038">CIndexedPriorityQueue.cpp:38</a></div></div>
<div class="ttc" id="classCModelEntity_html_a86cb8e66e255d66db258324064efc78aa8751c35af95ea9346908d9835a1b0570"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa8751c35af95ea9346908d9835a1b0570">CModelEntity::FIXED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da3/CModelValue_8h_source.html#l00055">CModelValue.h:55</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_a18357c86629fe757e3120258ce81ef56a3b736192222fcb8ee487a9c36bbd9867"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a3b736192222fcb8ee487a9c36bbd9867">CCopasiParameter::DOUBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00041">CCopasiParameter.h:41</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a2f841429c7a79c2695aa696ac5820884"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a2f841429c7a79c2695aa696ac5820884">CHybridMethod::cleanup</a></div><div class="ttdeci">void cleanup()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00319">CHybridMethod.cpp:319</a></div></div>
<div class="ttc" id="classCCopasiParameterGroup_html_a9df83bc5bbee7b715f7196fd4a8b0a84"><div class="ttname"><a href="../../df/d89/classCCopasiParameterGroup.html#a9df83bc5bbee7b715f7196fd4a8b0a84">CCopasiParameterGroup::getParameter</a></div><div class="ttdeci">CCopasiParameter * getParameter(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d56/CCopasiParameterGroup_8cpp_source.html#l00343">CCopasiParameterGroup.cpp:343</a></div></div>
<div class="ttc" id="CMetab_8h_html"><div class="ttname"><a href="../../d3/df5/CMetab_8h.html">CMetab.h</a></div></div>
<div class="ttc" id="CTrajectoryProblem_8h_html"><div class="ttname"><a href="../../d4/de2/CTrajectoryProblem_8h.html">CTrajectoryProblem.h</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html_ab3518ff2426cb53acd8f96cd73abaa4fab89a8c9ac9789a8cc1fb9f56ae571eb1"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html#ab3518ff2426cb53acd8f96cd73abaa4fab89a8c9ac9789a8cc1fb9f56ae571eb1">CTrajectoryMethod::NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7d/CTrajectoryMethod_8h_source.html#l00052">CTrajectoryMethod.h:52</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ad2031dcea4dcecae4ab4c8f26aa9857f"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ad2031dcea4dcecae4ab4c8f26aa9857f">CHybridMethod::getAffects</a></div><div class="ttdeci">std::set&lt; std::string &gt; * getAffects(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01331">CHybridMethod.cpp:1331</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a32b90a7983cd6161e023821baa81a64d"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a32b90a7983cd6161e023821baa81a64d">CHybridMethod::setupMetab2React</a></div><div class="ttdeci">void setupMetab2React()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00964">CHybridMethod.cpp:964</a></div></div>
<div class="ttc" id="classCHybridStochFlag_html_a2b5014e8be75b40a5aa5875d42ca0e1d"><div class="ttname"><a href="../../d0/d6c/classCHybridStochFlag.html#a2b5014e8be75b40a5aa5875d42ca0e1d">CHybridStochFlag::mpNext</a></div><div class="ttdeci">CHybridStochFlag * mpNext</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00092">CHybridMethod.h:92</a></div></div>
<div class="ttc" id="classCModel_html_a0953a21acfd7376debc68787923bbe74"><div class="ttname"><a href="../../d4/d04/classCModel.html#a0953a21acfd7376debc68787923bbe74">CModel::getNumIndependentReactionMetabs</a></div><div class="ttdeci">size_t getNumIndependentReactionMetabs() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01130">CModel.cpp:1130</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_a32da70ad484168c4bd928cc847897c3e"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#a32da70ad484168c4bd928cc847897c3e">CIndexedPriorityQueue::removeStochReaction</a></div><div class="ttdeci">size_t removeStochReaction(const size_t index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00044">CIndexedPriorityQueue.cpp:44</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a02b684a9b18a5751e6d8c665f9a0e09d"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a02b684a9b18a5751e6d8c665f9a0e09d">CHybridMethod::mpMetabolites</a></div><div class="ttdeci">CCopasiVector&lt; CMetab &gt; * mpMetabolites</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00520">CHybridMethod.h:520</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a2983e42fc7d66179b720fedffc58909e"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a2983e42fc7d66179b720fedffc58909e">CHybridMethod::calculateAmu</a></div><div class="ttdeci">void calculateAmu(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00691">CHybridMethod.cpp:691</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a56d9322780d3fa6ffd80b7ea0ad4ed68"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a56d9322780d3fa6ffd80b7ea0ad4ed68">CHybridMethod::mAmu</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; mAmu</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00593">CHybridMethod.h:593</a></div></div>
<div class="ttc" id="CCompartment_8h_html"><div class="ttname"><a href="../../d8/d59/CCompartment_8h.html">CCompartment.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aa2568cf74b74743d5c93f5b417adbf0c"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aa2568cf74b74743d5c93f5b417adbf0c">CHybridMethod::mStepsAfterPartitionSystem</a></div><div class="ttdeci">size_t mStepsAfterPartitionSystem</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00578">CHybridMethod.h:578</a></div></div>
<div class="ttc" id="unionCCopasiParameter_1_1Value_html_a438dcaf539adf7130f2c4f2b193bb136"><div class="ttname"><a href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a438dcaf539adf7130f2c4f2b193bb136">CCopasiParameter::Value::pDOUBLE</a></div><div class="ttdeci">C_FLOAT64 * pDOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00057">CCopasiParameter.h:57</a></div></div>
<div class="ttc" id="classCHybridMethod_html_af169416dc4053086a6ab53f064058c31"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#af169416dc4053086a6ab53f064058c31">CHybridMethod::mStepsize</a></div><div class="ttdeci">C_FLOAT64 mStepsize</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00583">CHybridMethod.h:583</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a884b2a01f42003ecfaa8bc8838ae8e19"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a884b2a01f42003ecfaa8bc8838ae8e19">CHybridMethod::updatePriorityQueue</a></div><div class="ttdeci">void updatePriorityQueue(size_t rIndex, C_FLOAT64 time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00625">CHybridMethod.cpp:625</a></div></div>
<div class="ttc" id="f2c_8h_html_abf5d144da384425ae6cb542ce6eec8d3"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a></div><div class="ttdeci">long int flag</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00052">f2c.h:52</a></div></div>
<div class="ttc" id="classCMetab_html_aefdb588dfa4f688ec4fe63e9486ff760"><div class="ttname"><a href="../../dc/d44/classCMetab.html#aefdb588dfa4f688ec4fe63e9486ff760">CMetab::refreshConcentration</a></div><div class="ttdeci">void refreshConcentration()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d70/CMetab_8cpp_source.html#l00281">CMetab.cpp:281</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_a18357c86629fe757e3120258ce81ef56a9e2b14ee7ce99139e3caa975794646ae"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a9e2b14ee7ce99139e3caa975794646ae">CCopasiParameter::INT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00043">CCopasiParameter.h:43</a></div></div>
<div class="ttc" id="classCModel_html_a7d405db8dc8120b942aa0ec1e80db399"><div class="ttname"><a href="../../d4/d04/classCModel.html#a7d405db8dc8120b942aa0ec1e80db399">CModel::getCompartments</a></div><div class="ttdeci">CCopasiVectorNS&lt; CCompartment &gt; &amp; getCompartments()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01145">CModel.cpp:1145</a></div></div>
<div class="ttc" id="classCCopasiMessage_html_a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505"><div class="ttname"><a href="../../d2/df0/classCCopasiMessage.html#a2ea1ed32494ff5c8d84353efcec7a5e4a26a213bf509c2f6ee21982b4f7a18505">CCopasiMessage::ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/CCopasiMessage_8h_source.html#l00092">CCopasiMessage.h:92</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_af35ebf85f77fdad1e197dea8495f2d2c"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#af35ebf85f77fdad1e197dea8495f2d2c">CIndexedPriorityQueue::updateNode</a></div><div class="ttdeci">void updateNode(const size_t index, const C_FLOAT64 key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00138">CIndexedPriorityQueue.cpp:138</a></div></div>
<div class="ttc" id="classCCopasiMessage_html"><div class="ttname"><a href="../../d2/df0/classCCopasiMessage.html">CCopasiMessage</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d2d/CCopasiMessage_8h_source.html#l00078">CCopasiMessage.h:78</a></div></div>
<div class="ttc" id="classCModelEntity_html_ac411005efc9db817150b2bd95303d53c"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#ac411005efc9db817150b2bd95303d53c">CModelEntity::getValue</a></div><div class="ttdeci">const C_FLOAT64 &amp; getValue() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da3/CModelValue_8cpp_source.html#l00136">CModelValue.cpp:136</a></div></div>
<div class="ttc" id="classCHybridNextReactionRKMethod_html"><div class="ttname"><a href="../../d9/d92/classCHybridNextReactionRKMethod.html">CHybridNextReactionRKMethod</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df7/CHybridNextReactionRKMethod_8h_source.html#l00037">CHybridNextReactionRKMethod.h:37</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a714f98c445d63eb279481e1f010b59bd"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a714f98c445d63eb279481e1f010b59bd">CHybridMethod::mPartitioningInterval</a></div><div class="ttdeci">unsigned C_INT32 mPartitioningInterval</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00573">CHybridMethod.h:573</a></div></div>
<div class="ttc" id="classCState_html_a4ed821e8fe51853bf62fc1ab56c10982"><div class="ttname"><a href="../../dc/d1d/classCState.html#a4ed821e8fe51853bf62fc1ab56c10982">CState::getTime</a></div><div class="ttdeci">const C_FLOAT64 &amp; getTime() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5a/CState_8cpp_source.html#l00325">CState.cpp:325</a></div></div>
<div class="ttc" id="classCCopasiVector_html_a8c53303b8661506a7de88a154699b234"><div class="ttname"><a href="../../d8/d2c/classCCopasiVector.html#a8c53303b8661506a7de88a154699b234">CCopasiVector::getIndex</a></div><div class="ttdeci">virtual size_t getIndex(const CCopasiObject *pObject) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d51/CCopasiVector_8h_source.html#l00462">CCopasiVector.h:462</a></div></div>
<div class="ttc" id="classCHybridMethod_html_af954f8e3d7e6e720825222c55bbf3a99"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#af954f8e3d7e6e720825222c55bbf3a99">CHybridMethod::setupPriorityQueue</a></div><div class="ttdeci">void setupPriorityQueue(C_FLOAT64 startTime=0.0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01135">CHybridMethod.cpp:1135</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4930c4d80ce52866a7adae0723cb6560"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4930c4d80ce52866a7adae0723cb6560">CHybridMethod::isValidProblem</a></div><div class="ttdeci">virtual bool isValidProblem(const CCopasiProblem *pProblem)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01714">CHybridMethod.cpp:1714</a></div></div>
<div class="ttc" id="classCHybridMethod_html"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html">CHybridMethod</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00113">CHybridMethod.h:113</a></div></div>
<div class="ttc" id="copasi_8h_html_ac4f8f8fcd12a8115cd9802d04a557125"><div class="ttname"><a href="../../dc/df8/copasi_8h.html#ac4f8f8fcd12a8115cd9802d04a557125">C_FLOAT64</a></div><div class="ttdeci">#define C_FLOAT64</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df8/copasi_8h_source.html#l00092">copasi.h:92</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5cc589ee7dcf6d89d7f05b1d4534950fab7c8746f90bec501424c815ccbf5c6c2"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5cc589ee7dcf6d89d7f05b1d4534950fab7c8746f90bec501424c815ccbf5c6c2">CHybridMethod::HIGH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00462">CHybridMethod.h:462</a></div></div>
<div class="ttc" id="CChemEqElement_8h_html"><div class="ttname"><a href="../../db/d8d/CChemEqElement_8h.html">CChemEqElement.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_aa5b4c690636f6590b09f9894af6293db"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#aa5b4c690636f6590b09f9894af6293db">CHybridMethod::mOutputCounter</a></div><div class="ttdeci">size_t mOutputCounter</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00635">CHybridMethod.h:635</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ad4552502d7f71b598453e93fa984e7fa"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ad4552502d7f71b598453e93fa984e7fa">CHybridMethod::currentState</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; currentState</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00531">CHybridMethod.h:531</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac72d68ec4625fd5ae8d68844f3640eb4"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac72d68ec4625fd5ae8d68844f3640eb4">CHybridMethod::k2</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; k2</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00533">CHybridMethod.h:533</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a8913fe8f85a708defe69441a93bd81f9"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a8913fe8f85a708defe69441a93bd81f9">CHybridMethod::insertDeterministicReaction</a></div><div class="ttdeci">void insertDeterministicReaction(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01224">CHybridMethod.cpp:1224</a></div></div>
<div class="ttc" id="classCModel_html_acfb4df497a8bab1bdde3d275c37fa2d5"><div class="ttname"><a href="../../d4/d04/classCModel.html#acfb4df497a8bab1bdde3d275c37fa2d5">CModel::getStateTemplate</a></div><div class="ttdeci">const CStateTemplate &amp; getStateTemplate() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01172">CModel.cpp:1172</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a9571083777bd5be517be51a9491ddd9a"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a9571083777bd5be517be51a9491ddd9a">CHybridMethod::mLocalSubstrates</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; CHybridBalance &gt; &gt; mLocalSubstrates</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00561">CHybridMethod.h:561</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a8f732c6c0cd0c5fffe6b40674fa24f49"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a8f732c6c0cd0c5fffe6b40674fa24f49">CHybridMethod::mRandomSeed</a></div><div class="ttdeci">unsigned C_INT32 mRandomSeed</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00495">CHybridMethod.h:495</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5ee65df6b820ebc657dcf21bd146a6ed"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5ee65df6b820ebc657dcf21bd146a6ed">CHybridMethod::createHybridMethod</a></div><div class="ttdeci">static CHybridMethod * createHybridMethod()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00153">CHybridMethod.cpp:153</a></div></div>
<div class="ttc" id="classCModel_html_a2ca23ed55dff7e2bf82de254176509fb"><div class="ttname"><a href="../../d4/d04/classCModel.html#a2ca23ed55dff7e2bf82de254176509fb">CModel::getNumModelValues</a></div><div class="ttdeci">size_t getNumModelValues() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01139">CModel.cpp:1139</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_a18357c86629fe757e3120258ce81ef56a098d4c1de3342cc22177fe93ce9f5320"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#a18357c86629fe757e3120258ce81ef56a098d4c1de3342cc22177fe93ce9f5320">CCopasiParameter::UINT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00044">CCopasiParameter.h:44</a></div></div>
<div class="ttc" id="classCModel_html_aceafaf1b517c3b0fd1989c1004d669f7"><div class="ttname"><a href="../../d4/d04/classCModel.html#aceafaf1b517c3b0fd1989c1004d669f7">CModel::getModelType</a></div><div class="ttdeci">const ModelType &amp; getModelType() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l02339">CModel.cpp:2339</a></div></div>
<div class="ttc" id="classCModel_html_ad9a3dc1905f1f38f689f728b829f285d"><div class="ttname"><a href="../../d4/d04/classCModel.html#ad9a3dc1905f1f38f689f728b829f285d">CModel::getReactions</a></div><div class="ttdeci">CCopasiVectorNS&lt; CReaction &gt; &amp; getReactions()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01039">CModel.cpp:1039</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac98effcd4b9ed2662aa9747d77ec538f"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac98effcd4b9ed2662aa9747d77ec538f">CHybridMethod::mLocalBalances</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; CHybridBalance &gt; &gt; mLocalBalances</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00555">CHybridMethod.h:555</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a9e7be266fb78a6bd4431fd68bc83bb57"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a9e7be266fb78a6bd4431fd68bc83bb57">CHybridMethod::mMetab2React</a></div><div class="ttdeci">std::vector&lt; std::set&lt; size_t &gt; &gt; mMetab2React</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00588">CHybridMethod.h:588</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac774b53601a49a5d158fc4274fb9ac84"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac774b53601a49a5d158fc4274fb9ac84">CHybridMethod::integrateDeterministicPartEuler</a></div><div class="ttdeci">void integrateDeterministicPartEuler(C_FLOAT64 ds)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00367">CHybridMethod.cpp:367</a></div></div>
<div class="ttc" id="CState_8h_html"><div class="ttname"><a href="../../de/d11/CState_8h.html">CState.h</a></div></div>
<div class="ttc" id="classCCopasiParameterGroup_html_a136c6bcced17f65672e44316cc2e90e7"><div class="ttname"><a href="../../df/d89/classCCopasiParameterGroup.html#a136c6bcced17f65672e44316cc2e90e7">CCopasiParameterGroup::assertParameter</a></div><div class="ttdeci">CCopasiParameter * assertParameter(const std::string &amp;name, const CCopasiParameter::Type type, const CType &amp;defaultValue)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d95/CCopasiParameterGroup_8h_source.html#l00190">CCopasiParameterGroup.h:190</a></div></div>
<div class="ttc" id="classCModelEntity_html_a86cb8e66e255d66db258324064efc78aa3c62c1c3a449e106a5f1eb2f4ff01ec3"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#a86cb8e66e255d66db258324064efc78aa3c62c1c3a449e106a5f1eb2f4ff01ec3">CModelEntity::ODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da3/CModelValue_8h_source.html#l00060">CModelValue.h:60</a></div></div>
<div class="ttc" id="classCFunctionParameter_html_ab0b7b0afa5fb363d6000f102b8590a1babe45d3446d5eecf154656899eb0e8de1"><div class="ttname"><a href="../../d2/d4b/classCFunctionParameter.html#ab0b7b0afa5fb363d6000f102b8590a1babe45d3446d5eecf154656899eb0e8de1">CFunctionParameter::PARAMETER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d59/CFunctionParameter_8h_source.html#l00047">CFunctionParameter.h:47</a></div></div>
<div class="ttc" id="classCModel_html"><div class="ttname"><a href="../../d4/d04/classCModel.html">CModel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/CModel_8h_source.html#l00050">CModel.h:50</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html_a1213f9ba799185fbad26dfbd6aff8f41"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html#a1213f9ba799185fbad26dfbd6aff8f41">CTrajectoryMethod::mpCurrentState</a></div><div class="ttdeci">CState * mpCurrentState</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7d/CTrajectoryMethod_8h_source.html#l00063">CTrajectoryMethod.h:63</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ab9af5950130324681a6468cb8397c771"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ab9af5950130324681a6468cb8397c771">CHybridMethod::start</a></div><div class="ttdeci">virtual void start(const CState *initialState)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00230">CHybridMethod.cpp:230</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html">CTrajectoryMethod</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7d/CTrajectoryMethod_8h_source.html#l00043">CTrajectoryMethod.h:43</a></div></div>
<div class="ttc" id="classCHybridBalance_html_a25f7ab840193c86b01c0857421c34d62"><div class="ttname"><a href="../../d0/df3/classCHybridBalance.html#a25f7ab840193c86b01c0857421c34d62">CHybridBalance::mpMetabolite</a></div><div class="ttdeci">CMetab * mpMetabolite</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00107">CHybridMethod.h:107</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5c8a0945bf858ee5105a42d2f9168229"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5c8a0945bf858ee5105a42d2f9168229">CHybridMethod::mUpperStochLimit</a></div><div class="ttdeci">C_FLOAT64 mUpperStochLimit</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00568">CHybridMethod.h:568</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a755cbc2076947364560a8258bcc0ee92"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a755cbc2076947364560a8258bcc0ee92">CHybridMethod::k1</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; k1</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00532">CHybridMethod.h:532</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_aac0420de934a306a2b8ab1bfef784537"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#aac0420de934a306a2b8ab1bfef784537">RUNGE_KUTTA_STEPSIZE</a></div><div class="ttdeci">#define RUNGE_KUTTA_STEPSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00062">CHybridMethod.h:62</a></div></div>
<div class="ttc" id="classCModelEntity_html_ad6bdcaa2e8887271f61fc363262cc9ed"><div class="ttname"><a href="../../d0/da0/classCModelEntity.html#ad6bdcaa2e8887271f61fc363262cc9ed">CModelEntity::getStatus</a></div><div class="ttdeci">const CModelEntity::Status &amp; getStatus() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da3/CModelValue_8cpp_source.html#l00141">CModelValue.cpp:141</a></div></div>
<div class="ttc" id="classCCopasiContainer_html"><div class="ttname"><a href="../../d9/dfd/classCCopasiContainer.html">CCopasiContainer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d70/CCopasiContainer_8h_source.html#l00037">CCopasiContainer.h:37</a></div></div>
<div class="ttc" id="classCModel_html_a438f349ee9b9f6963c7ce9db96b4eb65"><div class="ttname"><a href="../../d4/d04/classCModel.html#a438f349ee9b9f6963c7ce9db96b4eb65">CModel::getMetabolitesX</a></div><div class="ttdeci">const CCopasiVector&lt; CMetab &gt; &amp; getMetabolitesX() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01057">CModel.cpp:1057</a></div></div>
<div class="ttc" id="classCHybridBalance_html_a1359f3c4710ea0b51337d06a9999e8aa"><div class="ttname"><a href="../../d0/df3/classCHybridBalance.html#a1359f3c4710ea0b51337d06a9999e8aa">CHybridBalance::mMultiplicity</a></div><div class="ttdeci">C_INT32 mMultiplicity</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00106">CHybridMethod.h:106</a></div></div>
<div class="ttc" id="classCModel_html_a12ea59078191e453908df685b7b2551f"><div class="ttname"><a href="../../d4/d04/classCModel.html#a12ea59078191e453908df685b7b2551f">CModel::getStoi</a></div><div class="ttdeci">const CMatrix&lt; C_FLOAT64 &gt; &amp; getStoi() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l01160">CModel.cpp:1160</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a52c10d1d939321015346c55dca384693"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a52c10d1d939321015346c55dca384693">CHybridMethod::mUpdateSet</a></div><div class="ttdeci">std::set&lt; size_t &gt; mUpdateSet</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00599">CHybridMethod.h:599</a></div></div>
<div class="ttc" id="classCHybridMethod_html_ac04148dea3e3ec30876c2da92a2d701b"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#ac04148dea3e3ec30876c2da92a2d701b">CHybridMethod::mAmuOld</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; mAmuOld</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00594">CHybridMethod.h:594</a></div></div>
<div class="ttc" id="CChemEq_8h_html"><div class="ttname"><a href="../../d8/dff/CChemEq_8h.html">CChemEq.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a9802043e8d3ed10063502e4513ae2335"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a9802043e8d3ed10063502e4513ae2335">CHybridMethod::mDoCorrection</a></div><div class="ttdeci">bool mDoCorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00510">CHybridMethod.h:510</a></div></div>
<div class="ttc" id="classCMatrix_html_a8cb7b9f0fac3fc922713fe23777e6c3a"><div class="ttname"><a href="../../d7/dd7/classCMatrix.html#a8cb7b9f0fac3fc922713fe23777e6c3a">CMatrix::numCols</a></div><div class="ttdeci">virtual size_t numCols() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dbd/CMatrix_8h_source.html#l00144">CMatrix.h:144</a></div></div>
<div class="ttc" id="classCHybridMethod_html_afa5e95d65abe506542903475f43aa57a"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#afa5e95d65abe506542903475f43aa57a">CHybridMethod::temp</a></div><div class="ttdeci">std::vector&lt; C_FLOAT64 &gt; temp</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00530">CHybridMethod.h:530</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a40a046d84dd6fd877d3846caedc5bb4a"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a40a046d84dd6fd877d3846caedc5bb4a">CHybridMethod::fireReaction</a></div><div class="ttdeci">void fireReaction(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00588">CHybridMethod.cpp:588</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a0b7e7e46bd368cc4eabb06f3a3f8bbd1"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a0b7e7e46bd368cc4eabb06f3a3f8bbd1">CHybridMethod::mReactionFlags</a></div><div class="ttdeci">std::vector&lt; CHybridStochFlag &gt; mReactionFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00542">CHybridMethod.h:542</a></div></div>
<div class="ttc" id="classCHybridStochFlag_html"><div class="ttname"><a href="../../d0/d6c/classCHybridStochFlag.html">CHybridStochFlag</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00086">CHybridMethod.h:86</a></div></div>
<div class="ttc" id="classCTrajectoryMethod_html_ab3518ff2426cb53acd8f96cd73abaa4f"><div class="ttname"><a href="../../d0/dc9/classCTrajectoryMethod.html#ab3518ff2426cb53acd8f96cd73abaa4f">CTrajectoryMethod::Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7d/CTrajectoryMethod_8h_source.html#l00049">CTrajectoryMethod.h:49</a></div></div>
<div class="ttc" id="classCModel_html_a7071c6d0aa1587c71ddb399733545e07"><div class="ttname"><a href="../../d4/d04/classCModel.html#a7071c6d0aa1587c71ddb399733545e07">CModel::suitableForStochasticSimulation</a></div><div class="ttdeci">std::string suitableForStochasticSimulation() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d08/CModel_8cpp_source.html#l03901">CModel.cpp:3901</a></div></div>
<div class="ttc" id="classCCopasiProblem_html_a62fb1aec73eb2898f994dd40bfceaa93"><div class="ttname"><a href="../../d1/d05/classCCopasiProblem.html#a62fb1aec73eb2898f994dd40bfceaa93">CCopasiProblem::getModel</a></div><div class="ttdeci">CModel * getModel() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d05/CCopasiProblem_8cpp_source.html#l00070">CCopasiProblem.cpp:70</a></div></div>
<div class="ttc" id="CDependencyGraph_8h_html"><div class="ttname"><a href="../../d0/d07/CDependencyGraph_8h.html">CDependencyGraph.h</a></div></div>
<div class="ttc" id="unionCCopasiParameter_1_1Value_html_a8c94ab18ba3f3a90c861b5a86852a39e"><div class="ttname"><a href="../../d8/dea/unionCCopasiParameter_1_1Value.html#a8c94ab18ba3f3a90c861b5a86852a39e">CCopasiParameter::Value::pBOOL</a></div><div class="ttdeci">bool * pBOOL</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00061">CCopasiParameter.h:61</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a7c1ee0898371a0af8c38f24fb4fd991e"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a7c1ee0898371a0af8c38f24fb4fd991e">CHybridMethod::getDependsOn</a></div><div class="ttdeci">std::set&lt; std::string &gt; * getDependsOn(size_t rIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01298">CHybridMethod.cpp:1298</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a4dabf2e2676eb38aeda156fdcf2a7904"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a4dabf2e2676eb38aeda156fdcf2a7904">CHybridMethod::mNumVariableMetabs</a></div><div class="ttdeci">size_t mNumVariableMetabs</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00472">CHybridMethod.h:472</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a5b09e2f1e7ff2d4db84388a5aa2d20bb"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a5b09e2f1e7ff2d4db84388a5aa2d20bb">CHybridMethod::setupPartition</a></div><div class="ttdeci">void setupPartition()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01055">CHybridMethod.cpp:1055</a></div></div>
<div class="ttc" id="classCIndexedPriorityQueue_html_aad3af2a0fa4684262ec4c4049a3e059e"><div class="ttname"><a href="../../d6/db8/classCIndexedPriorityQueue.html#aad3af2a0fa4684262ec4c4049a3e059e">CIndexedPriorityQueue::initializeIndexPointer</a></div><div class="ttdeci">void initializeIndexPointer(const size_t numberOfReactions)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9c/CIndexedPriorityQueue_8cpp_source.html#l00092">CIndexedPriorityQueue.cpp:92</a></div></div>
<div class="ttc" id="classCCopasiParameter_html_af7c874dee22c599e9298e41619171b3f"><div class="ttname"><a href="../../d5/db6/classCCopasiParameter.html#af7c874dee22c599e9298e41619171b3f">CCopasiParameter::mValue</a></div><div class="ttdeci">Value mValue</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/CCopasiParameter_8h_source.html#l00103">CCopasiParameter.h:103</a></div></div>
<div class="ttc" id="CHybridMethod_8h_html_ab96a75318b9c264bf8aff3eb86b5a259"><div class="ttname"><a href="../../d2/dda/CHybridMethod_8h.html#ab96a75318b9c264bf8aff3eb86b5a259">LOWER_STOCH_LIMIT</a></div><div class="ttdeci">#define LOWER_STOCH_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dda/CHybridMethod_8h_source.html#l00060">CHybridMethod.h:60</a></div></div>
<div class="ttc" id="classCState_html_a15e3647f764be63737bdaf898299ef18"><div class="ttname"><a href="../../dc/d1d/classCState.html#a15e3647f764be63737bdaf898299ef18">CState::beginIndependent</a></div><div class="ttdeci">C_FLOAT64 * beginIndependent()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5a/CState_8cpp_source.html#l00328">CState.cpp:328</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a74dd307cee2fecfcfc19032be5446521"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a74dd307cee2fecfcfc19032be5446521">CHybridMethod::modelHasAssignments</a></div><div class="ttdeci">static bool modelHasAssignments(const CModel *pModel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l01844">CHybridMethod.cpp:1844</a></div></div>
<div class="ttc" id="classCRandom_html_a4c60adfc235ed3a9ab82ba7427f6d35f"><div class="ttname"><a href="../../df/dcb/classCRandom.html#a4c60adfc235ed3a9ab82ba7427f6d35f">CRandom::initialize</a></div><div class="ttdeci">virtual void initialize(unsigned C_INT32 seed=CRandom::getSystemSeed())</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/df8/CRandom_8cpp_source.html#l00162">CRandom.cpp:162</a></div></div>
<div class="ttc" id="classCCopasiVector_html"><div class="ttname"><a href="../../d8/d2c/classCCopasiVector.html">CCopasiVector&lt; CMetab &gt;</a></div></div>
<div class="ttc" id="CReaction_8h_html"><div class="ttname"><a href="../../db/dc3/CReaction_8h.html">CReaction.h</a></div></div>
<div class="ttc" id="classCHybridMethod_html_a54edfed11a96ec6a1ae976adbe4217d2"><div class="ttname"><a href="../../d5/da3/classCHybridMethod.html#a54edfed11a96ec6a1ae976adbe4217d2">CHybridMethod::setupDependencyGraph</a></div><div class="ttdeci">void setupDependencyGraph()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/CHybridMethod_8cpp_source.html#l00900">CHybridMethod.cpp:900</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 2 2015 14:50:14 for COPASI API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
